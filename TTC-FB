from selenium import webdriver
from selenium.webdriver.chrome.service import Service
from pathlib import Path
from selenium.webdriver.chrome.options import Options
from selenium.common.exceptions import NoSuchElementException
from selenium.webdriver.common.by import By
from datetime import datetime
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support.ui import WebDriverWait
from webdriver_manager.chrome import ChromeDriverManager
from selenium.webdriver.support import expected_conditions as EC
import re
import platform
import os
import zipfile
import subprocess
import platform
import getpass
from selenium.webdriver.common.action_chains import ActionChains
import hashlib
import json
from pynput.keyboard import Controller, Key
from pynput import keyboard
import threading
import requests 
import multiprocessing
from rich.progress import Progress  
from rich.console import Console
import itertools
from multiprocessing import Process
from pathlib import Path
import base64
import os
import random
import sys
import time
import shutil
from colorama import Fore, Style, init
init(autoreset=True)
RED = Fore.RED
YELLOW = Fore.YELLOW
GREEN = Fore.GREEN
BLUE = Fore.BLUE
RESET = Style.RESET_ALL
MAGENTA = Fore.MAGENTA
success_count = 0
profile_path = None
profile = None
textcomment = None
passwords = None
bill = 0
done = 0
console = Console()
jobs_dict = {}
running = True
block = True
reaction_map = {
        "TH∆Ø∆†NG TH∆Ø∆†NG": "Th∆∞∆°ng th∆∞∆°ng",
        "LOVE": "Y√™u th√≠ch",
        "HAHA": "Haha",
        "WOW": "Wow",
        "BU·ªíN": "Bu·ªìn",
        "T·ª®C GI·∫¨N": "Ph·∫´n n·ªô"
    }
delete_script = """
const classNames = [
    "x1i10hfl x1qjc9v5 xjbqb8w xjqpnuy xa49m3k xqeqjp1 x2hbi6w x13fuv20 xu3j5b3 x1q0q8m5 x26u7qi x972fbf xcfux6l x1qhh985 xm0m39n x9f619 xdl72j9 x2lah0s xe8uvvx xdj266r x11i5rnm xat24cr x1mh8g0r x2lwn1j xeuugli xexx8yu x4uap5 x18d9i69 xkhd6sd x16tdsg8 x1hl2dhg xggy1nq x1ja2u2z x1t137rt x1o1ewxj x3x9cwd x1e5q0jg x13rtm0m x3nfvp2 x1q0g3np x87ps6o x1lku1pv x1a2a7pz x1ypdohk x5yr21d x1n2onr6 x3hqpx7", 
    "xds687c x17qophe xixxii4 x13vifvy x1vjfegm",
    "xds687c x1pi30zi x1e558r4 xixxii4 x13vifvy xzkaem6",
    "x6s0dn4 x9f619 x78zum5 x1iyjqo2 x1s65kcs x17qophe x1d52u69 xixxii4 x13vifvy xzkaem6",
    "html-div xdj266r x11i5rnm x1mh8g0r xexx8yu x18d9i69 x6s0dn4 x9f619 x78zum5 x1s65kcs x1wsgfga x1pi30zi x1swvt13",
    "html-div xdj266r x11i5rnm xat24cr x1mh8g0r xexx8yu x4uap5 x18d9i69 xkhd6sd x9f619 xdt5ytf xh8yej3 x1lliihq x1n2onr6 xhq5o37 x1qxoq08 x1cpjm7i x1ryaae9 x124lp2h x1hmns74 x1mhyesy x1y3wzot",
    "x1hc1fzr x1unhpq9 x6o7n8i",
    "x191j7n5 x92rtbv x10l6tqk x1useyqa",
    "x6s0dn4 x78zum5 x1a02dak x1a8lsjc x1pi30zi x1swvt13 xz9dl7a",
    "x9f619 x1n2onr6 x1ja2u2z x1wsgfga x9otpla xwib8y2 x1y1aw1k",
    "x78zum5 xdt5ytf x1iyjqo2 xh8yej3 xyzno7u x8dqta2",
    "x7wzq59 xxzkxad xh8yej3 xzkaem6",
    "x1lliihq x5yr21d xh8yej3",
    "x8gbvx8 x78zum5 x1q0g3np x1a02dak x1nhvcw1 x1rdy4ex xcud41i x4vbgl9 x139jcc6",
    "x1nb4dca x1q0q8m5 xso031l x1exxf4d x13fuv20 x178xt8z x1ey2m1c x9f619 xds687c x47corl x10l6tqk x17qophe x13vifvy",
    "panel panel-info",
    "col-md-12",
    "dropdown",
    "x78zum5 xdt5ytf x2lah0s x1pi30zi x18d9i69 x1swvt13 xyamay9",
    "x5yr21d x6ikm8r x10wlt62",
    "x9f619 x1ja2u2z xnp8db0 x112wk31 xnjgh8c xxc7z9f x1t2pt76 x1u2d2a2 x6ikm8r x10wlt62 x1xzczws x7wzq59 xxzkxad x9e5oc1",
    "x9f619 x1n2onr6 x78zum5 xdt5ytf x193iq5w xeuugli x2lah0s x1t2pt76 x1xzczws x1cvmir6 x1vjfegm x1daaz14",
    "x1jx94hy x78zum5 xdt5ytf x1iyjqo2 x1ja2u2z x6ikm8r x10wlt62",
    "x67bb7w x10l6tqk x92rtbv x1rco1iv",
    "x67bb7w x10l6tqk x1tk7jg1 x1memqgq",
    "x78zum5 x1a87ojn x1qughib x11f4b5y x10l6tqk x1tk7jg1 x1oysuqx",
    "x1ey2m1c x78zum5 xdt5ytf xozqiw3 x17qophe x13a6bvl x10l6tqk x13vifvy xq2gx43 xh8yej3",
    "xsxvzsj x1m3v4wt x17qophe x10l6tqk x13vifvy xjl7whj"
];

(function() {
    function removeElements() {
        classNames.forEach(className => {
            const selector = className.split(" ").map(cn => "." + cn).join("");
            document.querySelectorAll(selector).forEach(el => el.remove());
        });
        console.log("‚úÖ ƒê√£ xo√° c√°c ph·∫ßn t·ª≠.");
    }

    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", removeElements);
    } else {
        removeElements();
    }
})();
"""

def get_next_core():
    """T·ª± ƒë·ªông l·∫•y core ti·∫øp theo ƒë·ªÉ c√¢n b·∫±ng t·∫£i"""
    num_cores = os.cpu_count()
    return (os.getpid() % num_cores)  # Chia ƒë·ªÅu gi·ªØa c√°c core


AUTHORIZED_PRO_DEVICES = {
    "Bluesea_157C42B61A25": "ADMIN NGUY·ªÑN ƒê√åNH HUYNH",
    "Bluesea_85d60d7ee7d2": "Tr·∫ßn Thanh Khang",
    "Bluesea_00163E03DC15": "Nguy·ªÖn Minh ƒê·ª©c",
    "Bluesea_928fb88cf584": "Nguy·ªÖn Ho√†ng ƒê·ª©c",
    "Bluesea_cf5adfb7a4a9": "ahn",
    "Bluesea_C392B2B69B68": "NGUY·ªÑN TH√ÄNH ƒê·∫†T",
    "Bluesea_4038624c0889": "V∆∞∆°ng VƒÉn M·∫°nh",
    "Bluesea_453c13276931": "Ti·∫øn ƒê·∫°t",
    "Bluesea_68b08e200182": "L√™ Minh V≈©",
    "Bluesea_e6e8d88bbf6f": "L√™ Back",
    "Bluesea_2980cacccdaa": "bee",
    "Bluesea_4798eea595cf": "Nguy·ªÖn Minh ƒê·ª©c",
    "Bluesea_be1e03f63014": "Nguy·ªÖn Thu·∫≠n Th√†nh",
    "Bluesea_943af6647220": "Bill Traver",
    "Bluesea_491a4c2b2ddf": "Bill Traver",
    "Bluesea_cbcd02286cbe": "Sang Nguy·ªÖn",
    "Bluesea_fba38889844f": "Nguy·ªÖn Ti·∫øn D≈©ng",
    "Bluesea_d5e6d64b2637": "V∆∞∆°ng",
    "Bluesea_880f344d9552": "So√°i",
    "Bluesea_7e754ca66701": "VƒÉn Ti·∫øn",
    "Bluesea_5ce2f9c03d5f": "H·ªì Khoa"
}
def Profile_tool():
    current_dir = Path(__file__).parent
    if os.name == 'nt':
        return Path(os.environ['USERPROFILE']) / "Profile_tool"
    elif os.name == 'posix' and platform.system() == 'Darwin':
        return Path.home() / "Profile_tool"
    else:
        return current_dir / "Profile_tool"
base_profile_path = Profile_tool()
os.makedirs(base_profile_path, exist_ok=True)
os_name = platform.system()
VERSION_FILE = base_profile_path / "version.txt"
CURRENT_VERSION = "Bluesea_3.BETA" 
os.environ["PYTHONWARNINGS"] = "ignore"  # ·∫®n c·∫£nh b√°o Python

#define h·ªá th·ªëng
def on_press(key):
    global running
    try:
        if key.char == "`":  # N·∫øu nh·∫•n 'x', d·ª´ng v√≤ng l·∫∑p
            print(f"\n ƒêang c·ªë d·ª´ng {RED}PROJECT{RESET}...")
            running = False
            return False  # D·ª´ng listener
    except AttributeError:
        pass


def get_stable_device_id():
    """T·∫°o ID c·ªë ƒë·ªãnh theo thi·∫øt b·ªã, ƒë·∫£m b·∫£o m√°y n√†o c≈©ng c√≥."""
    try:
        system = platform.system()
        if system == "Windows":
            import winreg
            key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, r"SOFTWARE\Microsoft\Cryptography")
            output, _ = winreg.QueryValueEx(key, "MachineGuid")
        elif system == "Darwin":
            output = os.popen("ioreg -rd1 -c IOPlatformExpertDevice | awk -F'\"' '/IOPlatformUUID/ {print $(NF-1)}'").read().strip()
        else:
            output = None
        if output:
            return output.replace("-", "")[:12]
    except Exception:
        pass
    fallback_id = platform.uname().node + platform.system()
    hashed_id = hashlib.sha256(fallback_id.encode()).hexdigest()[:12]
    return hashed_id

def generate_bluesea_id():
    return f"Bluesea_{get_stable_device_id()}"
def lay_data(base_path = base_profile_path):
    tran_profiles = {}
    pilot_profiles = {}
    for folder in os.listdir(base_path):
        folder_path = os.path.join(base_path, folder)
        if os.path.isdir(folder_path):
            if folder.startswith("pilot_"):
                zip_file = None
                sub_profiles = {}
                for item in os.listdir(folder_path):
                    item_path = os.path.join(folder_path, item)
                    if item.endswith(".zip"):
                        zip_file = item_path
                    elif os.path.isdir(item_path):
                        pass_path = os.path.join(item_path, "infomation.txt")
                        password = None
                        if os.path.exists(pass_path):
                            with open(pass_path, "r") as f:
                                password = f.read().strip().replace("password:", "").strip()
                        sub_profiles[item] = password
                pilot_profiles[folder] = {"zip": zip_file, "sub_profiles": sub_profiles}
            else:
                pass_path = os.path.join(folder_path, "infomation.txt")
                password = None
                if os.path.exists(pass_path):
                    with open(pass_path, "r") as f:
                        password = f.read().strip().replace("password:", "").strip()
                tran_profiles[folder] = password
    return tran_profiles, pilot_profiles
def quan_li(profile, password, environment, zip_file):
    profile_path = os.path.join(base_profile_path, environment, profile) if environment != "TRAN" else os.path.join(base_profile_path, profile)
    chrome_options = Options()
    chrome_options.add_argument(f"--user-data-dir={profile_path}")
    chrome_options.add_argument("--start-maximized")
    chrome_options.add_argument("--disable-gpu")  # T·∫Øt GPU ƒë·ªÉ tr√°nh l·ªói memory
    chrome_options.add_argument("--log-level=3")
    chrome_options.add_argument("--disable-features=WebGL,WebGL2")
    chrome_options.add_argument("--enable-features=Canvas,WebGL,WebGL2")
    prefs = {
    "profile.default_content_setting_values": {
        "images": 1,      # Load ·∫£nh b√¨nh th∆∞·ªùng
        "javascript": 1,  # Ch·∫°y JavaScript ƒë·∫ßy ƒë·ªß
        "cookies": 1,      # Kh√¥ng ch·∫∑n cookie
        "popups": 1,       # Kh√¥ng ch·∫∑n popup
        "plugins": 1       # Load t·∫•t c·∫£ plugin
    }
}
    chrome_options.add_experimental_option("prefs", prefs)
    if zip_file and os.path.exists(zip_file):
        chrome_options.add_extension(zip_file)
    service = Service(ChromeDriverManager().install())
    driver = webdriver.Chrome(service=service, options=chrome_options)
    driver.get("https://tuongtaccheo.com")
    try:
        WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[2]/li[2]/a'))).click()
        user = driver.find_element(By.XPATH, '/html/body/div[1]/div/div[4]/div/div[2]/form/input[1]')
        user.send_keys(profile) 
        passw = driver.find_element(By.XPATH, '/html/body/div[1]/div/div[4]/div/div[2]/form/input[2]')
        passw.send_keys(password)  
        driver.find_element(By.XPATH, '/html/body/div[1]/div/div[4]/div/div[2]/form/input[4]').click()
    except:
        print("L·ªói khi ƒëƒÉng nh·∫≠p!")
    driver.execute_script("window.open('https://facebook.com', '_blank');")
    return driver, profile_path
def thuc_thi(profile, password, environment, zip_file):
    profile_path = os.path.join(base_profile_path, environment, profile) if environment != "TRAN" else os.path.join(base_profile_path, profile)
    chrome_options = Options()
    chrome_options.add_argument(f"--user-data-dir={profile_path}")
    chrome_options.add_argument("--start-maximized")
    chrome_options.add_argument('--disable-blink-features=AutomationControlled')
    chrome_options.add_argument("--disable-notifications")
    chrome_options.add_argument("--disable-infobars") 
    chrome_options.add_argument("--disable-cache")
    chrome_options.add_argument("--mute-audio") 
    chrome_options.add_argument("--log-level=3") 
    chrome_options.add_argument("--no-sandbox")
    chrome_options.add_argument("--memory-pressure-off")
    chrome_options.add_argument("--blink-settings=imagesEnabled=false")
    chrome_options.add_argument("--disable-features=MediaEngagementBypassAutoplayPolicies")  # Ch·∫∑n autoplay
    chrome_options.add_argument("--autoplay-policy=no-user-gesture-required")  # Kh√¥ng cho ph√©p ph√°t video
    chrome_options.add_argument("--disable-background-video-track")  # Kh√¥ng load video n·ªÅn
    chrome_options.add_argument("--disable-background-media-suspend")  # T·∫Øt x·ª≠ l√Ω media n·ªÅn
    chrome_options.add_argument("--disable-webrtc-hw-decoding")  # T·∫Øt gi·∫£i m√£ video b·∫±ng GPU
    chrome_options.add_argument("--disable-webrtc-hw-encoding")  # T·∫Øt m√£ h√≥a video b·∫±ng GPU
    for arg in [  
    "--no-sandbox", "--disable-gpu", "--disable-software-rasterizer",  
    "--disable-dev-shm-usage", "--disable-crash-reporter", "--disable-extensions",  
    "--disable-in-process-stack-traces", "--disable-logging", "--disable-background-video-track",  
    "--disable-features=MediaEngagementBypassAutoplayPolicies,PreloadMediaEngagementData,WebRTC,WebAudio,AutoplayIgnoreWebAudio",  
    "--blink-settings=imagesEnabled=false", "--disable-sync", "--disable-background-timer-throttling",  
    "--disable-backgrounding-occluded-windows", "--disable-renderer-backgrounding",  
    ]: chrome_options.add_argument(arg)  
    for arg in ["--disable-features=MediaEngagementBypassAutoplayPolicies,PreloadMediaEngagementData,WebRTC,WebAudio,AutoplayIgnoreWebAudio",
            "--disable-background-video-track", "--disable-accelerated-video-decode", "--disable-software-rasterizer"]: chrome_options.add_argument(arg)  
    chrome_options.add_argument("--disable-gesture-requirement-for-media-playback")  # NgƒÉn video ch·∫°y t·ª± ƒë·ªông
    chrome_options.add_argument("--disable-animations")
    chrome_options.add_argument("--disable-sync")  # T·∫Øt ƒë·ªìng b·ªô Chrome
    chrome_options.add_argument("--metrics-recording-only")  # Ch·ªâ ghi nh·∫≠n d·ªØ li·ªáu c·∫ßn thi·∫øt
    chrome_options.add_argument("--mute-audio")  # T·∫Øt √¢m thanh (gi·∫£m x·ª≠ l√Ω ƒëa ph∆∞∆°ng ti·ªán)
    chrome_options.add_argument("--headless=new")
    chrome_options.add_argument("--disable-popup-blocking")  # T·∫Øt ch·∫∑n pop-up (tr√°nh l·ªói)
    chrome_options.add_argument("--disable-infobars")  # ·∫®n th√¥ng b√°o "Chrome ƒëang ƒë∆∞·ª£c ƒëi·ªÅu khi·ªÉn..."
    chrome_options.add_argument("--disable-notifications")  # Ch·∫∑n th√¥ng b√°o t·ª´ web
    chrome_options.add_argument("--disable-save-password-bubble")  # T·∫Øt g·ª£i √Ω l∆∞u m·∫≠t kh·∫©u
    chrome_options.add_argument("--disable-translate")  # T·∫Øt t√≠nh nƒÉng d·ªãch c·ªßa Chrome
    chrome_options.add_argument("--disk-cache-size=1000000000")  # 1GB cache
    chrome_options.add_argument("--disable-features=ScriptStreaming")  # Gi·∫£m t·∫£i x·ª≠ l√Ω JS
    chrome_options.add_argument("--mute-audio")
    chrome_options.add_argument("--process-per-site")  # Gi·∫£m s·ªë process c·ªßa Chrome
    chrome_options.add_argument("--disable-backgrounding-occluded-windows")  
    chrome_options.add_argument("--disable-renderer-backgrounding")  
    chrome_options.add_argument("--disable-features=ScriptStreaming") 
    chrome_options.add_argument("--disable-dev-shm-usage") 
    chrome_options.add_argument("--no-ssl-cert-check") 
    chrome_options.add_argument("--disable-software-rasterizer")  
    prefs = {"profile.managed_default_content_settings.images": 2, 
    "profile.managed_default_content_settings.stylesheets": 2, 
    "profile.managed_default_content_settings.fonts": 2}  
    chrome_options.add_experimental_option("prefs", prefs) 
    chrome_options.add_argument("--disable-gpu") 
    chrome_options.add_argument("--window-size=1920,1080")
    if zip_file and os.path.exists(zip_file):
        chrome_options.add_extension(zip_file)
    else:
        chrome_options.add_argument("--disable-extensions")
    service = Service(ChromeDriverManager().install())
    driver = webdriver.Chrome(service=service, options=chrome_options)
    url = ('https://tuongtaccheo.com')
    driver.get(url)
    try:
        wait = WebDriverWait(driver, 10)
        user = wait.until(EC.presence_of_element_located((By.ID, "name"))) 
        user.send_keys(profile)
        passw = wait.until(EC.presence_of_element_located((By.ID, "password")))
        passw.send_keys(password)
        login_button = wait.until(EC.element_to_be_clickable((By.XPATH, "//input[@type='submit']")))
        login_button.click()
    except Exception as e:
        print(f"L·ªói: {e}")
        time.sleep(0.1)
    return driver, profile_path
def care(profile, password, environment, zip_file):
    profile_path = os.path.join(base_profile_path, environment, profile) if environment != "TRAN" else os.path.join(base_profile_path, profile)
    chrome_options = Options()
    chrome_options.add_argument(f"--user-data-dir={profile_path}")
    chrome_options.add_argument("--start-maximized")
    chrome_options.add_argument('--disable-blink-features=AutomationControlled')
    chrome_options.add_argument("--disable-notifications")
    chrome_options.add_argument("--disable-infobars")
    chrome_options.add_argument("--disable-cache")
    chrome_options.add_argument("--disable-gpu")  # T·∫Øt GPU ƒë·ªÉ tr√°nh l·ªói memory
    chrome_options.add_argument("--log-level=3") 
    chrome_options.add_argument("--mute-audio")
    chrome_options.add_argument("--headless=new")
    chrome_options.add_argument("--no-sandbox")  
    chrome_options.add_argument("--disable-dev-shm-usage") 
    chrome_options.add_argument("--no-ssl-cert-check")  
    chrome_options.add_argument("--disable-software-rasterizer")  
    prefs = {"profile.managed_default_content_settings.images": 2,  
    "profile.managed_default_content_settings.stylesheets": 2,  
    "profile.managed_default_content_settings.fonts": 2} 
    chrome_options.add_experimental_option("prefs", prefs) 
    chrome_options.add_argument("--disable-gpu") 
    chrome_options.add_argument("--window-size=1920,1080")
    if zip_file and os.path.exists(zip_file):
        chrome_options.add_extension(zip_file)
    service = Service(ChromeDriverManager().install())
    driver = webdriver.Chrome(service=service, options=chrome_options)
    url = ('https://facebook.com')
    driver.get(url)
    time.sleep(5)  # ƒê·ª£i trang t·∫£i xo
    return driver
def tao_profile():
    while True:
        os.system('cls' if os.name == 'nt' else 'clear')
        print(f"\n==== {YELLOW}T·∫†O {RED}C·∫§U H√åNH{RESET} ====")
        print(f"\nPROJECT n√†y {RED}kh√¥ng xu·∫•t d·ªØ li·ªáu{RESET} v·ªÅ m√°y ch·ªß t·ª´ xa.")
        print(f"v√† t√¥i {RED}kh√¥ng c√≥ nhu c·∫ßu{RESET} thu th·∫≠p th√¥ng tin t√†i kho·∫£n c·ªßa b·∫°n.")
        accound_ttc = input(f"\nNh·∫≠p {GREEN}'T√äN ƒêƒÇNG NH·∫¨P T∆Ø∆†NG T√ÅC CH√âO'{RESET} c·ªßa b·∫°n: ").strip()
        password_ttc = input(f"Nh·∫≠p {GREEN}'M·∫¨T KH·∫®U T∆Ø∆†NG T√ÅC CH√âO'{RESET} c·ªßa b·∫°n: ").strip()
        options = Options()
        options.add_argument("--headless")
        options.add_argument("--disable-gpu")
        service = Service(ChromeDriverManager().install())
        driver = webdriver.Chrome(service=service, options=options)
        try:
            driver.get("https://tuongtaccheo.com")
            WebDriverWait(driver, 5).until(EC.presence_of_element_located((By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[2]/li[2]/a'))).click()
            user = driver.find_element(By.XPATH, '/html/body/div[1]/div/div[4]/div/div[2]/form/input[1]')
            user.send_keys(accound_ttc)
            passw = driver.find_element(By.XPATH, '/html/body/div[1]/div/div[4]/div/div[2]/form/input[2]')
            passw.send_keys(password_ttc)
            driver.find_element(By.XPATH, '/html/body/div[1]/div/div[4]/div/div[2]/form/input[4]').click()
            WebDriverWait(driver, 2).until(EC.presence_of_element_located((By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[2]/li[2]/a/strong')))
            profile_path = os.path.join(base_profile_path, accound_ttc)
            if not os.path.exists(profile_path):
                os.makedirs(profile_path)
            info_file_path = os.path.join(profile_path, 'infomation.txt')
            with open(info_file_path, 'w') as info_file:
                info_file.write(f"password:{password_ttc}")
            print(f"\nƒê√£ t·∫°o th√™m c·∫•u h√¨nh {GREEN}{accound_ttc}{RESET}")
            countdown(3)
            driver.quit()
            break
        except:
            print(f"\n{RED}T√ÄI KHO·∫¢N HO·∫∂C M·∫¨T KH·∫®U kh√¥ng ch√≠nh x√°c{RESET},vui l√≤ng th·ª≠ l·∫°i.")
            time.sleep(2)
        finally:
            driver.quit()
def clean(profile_path):
    files_to_keep = [
        "Cookies",
        "Login Data",
        "Local State",
        "Preferences",
        "Secure Preferences",
        "Bookmarks",
        "infomation.txt"
    ]
    
    folders_to_keep = [
        "Default/Local Storage/leveldb",   # Cookie & LocalStorage
        "Default/Session Storage",         # Tr·∫°ng th√°i phi√™n ƒëƒÉng nh·∫≠p
        "Default/IndexedDB",               # D·ªØ li·ªáu web
        "Default/Sync Data",               # ƒê·ªìng b·ªô t√†i kho·∫£n
        "Default/Extension State",         # Tr·∫°ng th√°i extension
        "Default/Network",                 # Tr√°nh m·∫•t k·∫øt n·ªëi
    ]
    
    # üî• C√°c th∆∞ m·ª•c n√™n x√≥a ƒë·ªÉ gi·∫£m dung l∆∞·ª£ng
    folders_to_delete = [
        "Default/Cache",                # Cache web
        "Default/Service Worker",        # Service Workers
        "Default/Code Cache",            # Code cache
        "Default/Media Cache",           # Cache media (·∫£nh, video)
        "Default/GPUCache",              # GPU cache
        "Default/Storage/ext",           # Storage c·ªßa extension
        "Default/File System",           # File System API r√°c
        "Default/AutofillStates",        # Tr·∫°ng th√°i t·ª± ƒë·ªông ƒëi·ªÅn
    ]
    
    # üóë X√≥a th∆∞ m·ª•c kh√¥ng quan tr·ªçng
    for folder in folders_to_delete:
        folder_path = os.path.join(profile_path, folder)
        if os.path.exists(folder_path):
            shutil.rmtree(folder_path, ignore_errors=True)
    
    # üóë X√≥a file r√°c (tr·ª´ file quan tr·ªçng)
    for item in os.listdir(profile_path):
        item_path = os.path.join(profile_path, item)
        if os.path.isfile(item_path) and item not in files_to_keep:
            try:
                os.remove(item_path)
            except Exception as e:
                pass
def clear():
    while True:
        os.system('cls' if os.name == 'nt' else 'clear')
        print(f"\n=== {YELLOW}CH·ªàNH S·ª¨A {GREEN}C·∫§U H√åNH{RESET} ===")
        print(f"[{RED}1{RESET}] X√≥a C·∫§U H√åNH trong m√¥i tr∆∞·ªùng {RED}TR·∫¶N{RESET}")
        print(f"[{RED}2{RESET}] X√≥a C·∫§U H√åNH trong m√¥i tr∆∞·ªùng {GREEN}PILOT{RESET}")
        print(f"[{RED}3{RESET}] X√≥a m√¥i tr∆∞·ªùng {GREEN}PILOT{RESET}")
        choice = input().strip().lower()
        if choice == "x":
            return
        tran_profiles, pilot_profiles = lay_data()
        if choice == "1":
            os.system('cls' if os.name == 'nt' else 'clear')
            if not tran_profiles:
                print(f"Kh√¥ng c√≥ {RED}C·∫§U H√åNH{RESET} n√†o trong m√¥i tr∆∞·ªùng TR·∫¶N.")
                countdown(3)
                continue
            print(f"\n=== M√îI TR∆Ø·ªúNG {RED}TR·∫¶N{RESET} ===")
            for i, (profile, password) in enumerate(tran_profiles.items(), start=1):
                print(f"[{RED}{i}{RESET}] {profile}")
            sub_choice = input().strip().lower()
            if sub_choice == "x":
                continue
            try:
                sub_choice = int(sub_choice)
                profile_to_delete = list(tran_profiles.keys())[sub_choice - 1]
                profile_path = os.path.join(base_profile_path, profile_to_delete)
                shutil.rmtree(profile_path)
                print(f"ƒê√£ x√≥a C·∫§U H√åNH '{YELLOW}{profile_to_delete}{RESET}' trong {RED}M√îI TR∆Ø·ªúNG TR·∫¶N{RESET}.")
                countdown(3)
            except (ValueError, IndexError):
                print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
                countdown(3)
        elif choice == "2":
            os.system('cls' if os.name == 'nt' else 'clear')
            if not pilot_profiles:
                print(f"Kh√¥ng c√≥ m√¥i tr∆∞·ªùng {GREEN}PILOT{RESET} n√†o.")
                countdown(3)
                continue
            index_offset = 1
            pilot_index_map = {}
            for pilot_name, data in pilot_profiles.items():
                print(f"\n {pilot_name} ({os.path.basename(data['zip'])}):")
                for sub_profile, password in data["sub_profiles"].items():
                    print(f"[{RED}{index_offset}{RESET}] {sub_profile}")
                    pilot_index_map[index_offset] = (pilot_name, sub_profile)
                    index_offset += 1
            sub_choice = input().strip().lower()
            if sub_choice == "x":
                continue
            try:
                sub_choice = int(sub_choice)
                pilot_name, profile_to_delete = pilot_index_map[sub_choice]
                profile_path = os.path.join(base_profile_path, pilot_name, profile_to_delete)   
                shutil.rmtree(profile_path)
                print(f"ƒê√£ x√≥a C·∫§U H√åNH '{YELLOW}{profile_to_delete}{RESET}' trong {GREEN}{pilot_name}{RESET}.")
                countdown(3)
            except (ValueError, IndexError):
                print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
                countdown(3)
        elif choice == "3":
            os.system('cls' if os.name == 'nt' else 'clear')
            if not pilot_profiles:
                print(f"Kh√¥ng c√≥ m√¥i tr∆∞·ªùng {GREEN}PILOT{RESET} n√†o.")
                countdown(3)
                continue
            print(f"\n=== M√îI TR∆Ø·ªúNG {GREEN}PILOT{RESET} ===")
            pilot_list = list(pilot_profiles.keys())
            for i, pilot_name in enumerate(pilot_list, start=1):
                print(f"[{i}] {pilot_name}")
            sub_choice = input().strip().lower()
            if sub_choice == "x":
                continue
            try:
                sub_choice = int(sub_choice)
                pilot_to_delete = pilot_list[sub_choice - 1]
                confirm = input(f"VI·ªÜC XO√Å {GREEN}M√îI TR∆Ø·ªúNG PILOT{RESET} S·∫º {YELLOW}XO√Å LU√îN C√ÅC C·∫§U H√åNH B√äN TRONG{RESET}\n H√ÉY CHUY·ªÇN RA M√îI TR∆Ø·ªúNG TR·∫¶N ƒê·ªÇ TR√ÅNH {RED}M·∫§T C·∫§U H√åNH{RESET} '{pilot_to_delete}'? \n({BLUE}'yes'{RESET} ƒë·ªÉ x√°c nh·∫≠n): ").strip().lower()
                if confirm == "yes":
                    shutil.rmtree(os.path.join(base_profile_path, pilot_to_delete))
                    print(f"ƒê√£ x√≥a to√†n b·ªô m√¥i tr∆∞·ªùng PILOT '{RED}{pilot_to_delete}{RESET}'.")
                    countdown(3)
                else:
                    print(f"H·ªßy x√≥a {GREEN}m√¥i tr∆∞·ªùng PILOT{RESET}.")
                    countdown(3)
            except (ValueError, IndexError):
                print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
                countdown(3)
        else:
            print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
            countdown(3)
#defent proxy 
def check_proxy(proxy):
    ip, port, user, password = proxy.split(":")
    proxy_url = f"http://{user}:{password}@{ip}:{port}"
    proxies = {"http": proxy_url, "https": proxy_url}
    check_urls = ["https://api64.ipify.org?format=text", "https://api.ipify.org?format=text"]
    for url in check_urls:
        try:
            response = requests.get(url, proxies=proxies, timeout=5)
            ip_type = "IPv6" if "api64" in url else "IPv4"
            print(f"Proxy ho·∫°t ƒë·ªông{BLUE} ({ip_type}): {response.text}{RESET}")
            countdown(5)
            print(f"{GREEN}M√îI TR∆Ø·ªúNG PILOT{RESET} ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng!")
            countdown(5)
            return True
        except requests.exceptions.RequestException:
            continue
    
    print(f"{RED}M√îI TR∆Ø·ªúNG PILOT{RESET} Kh√¥ng th·ªÉ t·∫°o do proxy kh√¥ng ho·∫°t ƒë·ªông.")
    time.sleep(3)
    return False
def create_proxy():
    print(f"==== {YELLOW}T·∫†O {GREEN}PROXY PILOT{RESET}")
    proxy_name = input(f"\nƒê·∫∑t {GREEN}T√™n{RESET} cho m√¥i tr∆∞·ªùng PILOT: ")
    proxy = input(f"Nh·∫≠p {RED}PROXY{RESET} theo ƒë·ªãnh d·∫°ng (IP:PORT:USER:PASSWORD): ")
    if not check_proxy(proxy):
        return None
    ip, port, user, password = proxy.split(":")
    profile_tool_path = Path.home() / "Profile_tool"
    proxy_folder = profile_tool_path / f"pilot_{proxy_name}"
    zip_file_path = proxy_folder / f"{ip}.zip"
    os.makedirs(proxy_folder, exist_ok=True)
    manifest_content = {
        "version": "1.0.0",
        "manifest_version": 2,
        "name": "Proxy Authentication",
        "permissions": ["proxy", "tabs", "storage", "<all_urls>", "webRequest", "webRequestBlocking"],
        "background": {"scripts": ["background.js"]}
    }
    background_content = f"""
    var config = {{
        mode: "fixed_servers",
        rules: {{
            singleProxy: {{
                scheme: "http",
                host: "{ip}",
                port: parseInt("{port}")
            }},
            bypassList: ["localhost"]
        }}
    }};

    chrome.proxy.settings.set({{ value: config, scope: "regular" }}, function(){{}});

    chrome.webRequest.onAuthRequired.addListener(
        function(details) {{
            return {{ authCredentials: {{ username: "{user}", password: "{password}" }} }};
        }},
        {{ urls: ["<all_urls>"] }},
        ["blocking"]
    );
    """
    manifest_path = proxy_folder / "manifest.json"
    background_path = proxy_folder / "background.js"
    with open(manifest_path, "w") as f:
        json.dump(manifest_content, f, indent=4)
    with open(background_path, "w") as f:
        f.write(background_content)
    with zipfile.ZipFile(zip_file_path, "w", zipfile.ZIP_DEFLATED) as zipf:
        zipf.write(manifest_path, "manifest.json")
        zipf.write(background_path, "background.js")
    os.remove(manifest_path)
    os.remove(background_path)
    time.sleep(5)
    return zip_file_path
def chuyen_profile():
    profiles = [f for f in os.listdir(base_profile_path) if os.path.isdir(os.path.join(base_profile_path, f))]
    profiles.sort()
    tran_profiles = []
    pilot_environments = {}
    for profile in profiles:
        profile_path = os.path.join(base_profile_path, profile)
        if profile.startswith("pilot_"):
            zip_files = [f for f in os.listdir(profile_path) if f.endswith('.zip')]
            sub_profiles = [f for f in os.listdir(profile_path) if os.path.isdir(os.path.join(profile_path, f))]
            ip = zip_files[0][:-4] if zip_files else "Kh√¥ng c√≥ IP"
            pilot_environments[profile] = {
                "ip": ip,
                "sub_profiles": sub_profiles
            }
        else:
            tran_profiles.append(profile)
    print(f"{RED}M√¥i tr∆∞·ªùng tr·∫ßn{RESET}:")
    for profile in tran_profiles:
        print(f"{RED}-{RESET} {profile}")
    for env, details in pilot_environments.items():
        ip = details["ip"]
        sub_profiles = details["sub_profiles"]
        print(f"\n{GREEN}M√¥i tr∆∞·ªùng {env}{RESET} ({ip}):")
        if sub_profiles:
            for sub_profile in sub_profiles:
                print(f"{GREEN}-{RESET} {sub_profile}")
        else:
            print(f":{RED}(Kh√¥ng c√≥ C·∫§U H√åNH){RESET}")
    tran_profiles = [f for f in os.listdir(base_profile_path) if os.path.isdir(os.path.join(base_profile_path, f)) and not f.startswith("pilot_")]
    pilots = [f for f in os.listdir(base_profile_path) if f.startswith("pilot_")]
    os.system('cls' if os.name == 'nt' else 'clear')
    print(f"\n=== {YELLOW}CH·ªàNH S·ª¨A {GREEN}C·∫§U H√åNH{RESET} ===")
    print(f"[{GREEN}1{RESET}] Chuy·ªÉn ƒë·ªïi v√†o M√îI TR∆Ø·ªúNG PILOT")
    print(f"[{RED}2{RESET}] Xu·∫•t kh·ªèi M√îI TR∆Ø·ªúNG PILOT")
    choice = input().strip()

    if choice == "1":
        if not tran_profiles:
            print(f"{YELLOW}Kh√¥ng c√≥{RESET} C·∫§U H√åNH n√†o trong m√¥i tr∆∞·ªùng tr·∫ßn!")
            return
        print(f"\nCh·ªçn C·∫§U H√åNH c·∫ßn chuy·ªÉn ƒë·ªïi v√†o {GREEN}M√îI TR∆Ø·ªúNG PILOT{RESET}:")
        for i, profile in enumerate(tran_profiles, 1):
            print(f"[{i}] {profile}")
        profile_choice = input().strip()
        if not profile_choice.isdigit() or int(profile_choice) < 1 or int(profile_choice) > len(tran_profiles):
            print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
            time.sleep(3)
            return
        selected_profile = tran_profiles[int(profile_choice) - 1]
        if pilots:
            print(f"\nCh·ªçn m√¥i tr∆∞·ªùng {GREEN}PILOT{RESET}:")
            for i, pilot in enumerate(pilots, 1):
                count = len([f for f in os.listdir(os.path.join(base_profile_path, pilot)) if os.path.isdir(os.path.join(base_profile_path, pilot, f))])
                print(f"[{i}] {pilot} ({GREEN}{count}{RESET}/{RED}3{RESET})")
            pilot_choice = input().strip()
            if pilot_choice.isdigit() and 1 <= int(pilot_choice) <= len(pilots):
                selected_pilot = pilots[int(pilot_choice) - 1]
            else:
                selected_pilot = f"pilot_{selected_profile}"
                os.makedirs(os.path.join(base_profile_path, selected_pilot), exist_ok=True)
        else:
            selected_pilot = f"pilot_{selected_profile}"
            os.makedirs(os.path.join(base_profile_path, selected_pilot), exist_ok=True)
        pilot_path = os.path.join(base_profile_path, selected_pilot)
        if len([f for f in os.listdir(pilot_path) if os.path.isdir(os.path.join(pilot_path, f))]) >= 3:
            print(f"M√¥i tr∆∞·ªùng {GREEN}PILOT{RED} ƒë√£ ƒë·ªß {RED}3{RESET} C·∫§U H√åNH!")
            return
        shutil.move(os.path.join(base_profile_path, selected_profile), pilot_path)
        print(f"ƒê√£ chuy·ªÉn {selected_profile} v√†o {GREEN}{selected_pilot}{RESET}")
        time.sleep(3)
    elif choice == "2":
        if not pilots:
            print(f"{YELLOW}Kh√¥ng c√≥{RESET} m√¥i tr∆∞·ªùng PILOT!")
            return
        print(f"\nCh·ªçn m√¥i tr∆∞·ªùng {GREEN}PILOT{RESET}:")
        for i, pilot in enumerate(pilots, 1):
            print(f"[{GREEN}{i}{RESET}] {pilot}")
        pilot_choice = input().strip()
        if not pilot_choice.isdigit() or int(pilot_choice) < 1 or int(pilot_choice) > len(pilots):
            print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
            return
        selected_pilot = pilots[int(pilot_choice) - 1]
        pilot_path = os.path.join(base_profile_path, selected_pilot)
        profiles_in_pilot = [f for f in os.listdir(pilot_path) if os.path.isdir(os.path.join(pilot_path, f))]
        if not profiles_in_pilot:
            print(f"{YELLOW}Kh√¥ng c√≥{RESET} C·∫§U H√åNH n√†o trong m√¥i tr∆∞·ªùng PILOT!")
            return
        print("\nCh·ªçn profile ƒë·ªÉ ƒë∆∞a v·ªÅ M√îI TR∆Ø·ªúNG TR·∫¶N:")
        for i, profile in enumerate(profiles_in_pilot, 1):
            print(f"[{RED}{i}{RESET}] {profile}")
        profile_choice = input().strip()
        if not profile_choice.isdigit() or int(profile_choice) < 1 or int(profile_choice) > len(profiles_in_pilot):
            print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
            time.sleep(3)
            return
        selected_profile = profiles_in_pilot[int(profile_choice) - 1]
        shutil.move(os.path.join(pilot_path, selected_profile), base_profile_path)
        print(f"ƒê√£ chuy·ªÉn {selected_profile} v·ªÅ {RED}M√îI TR∆Ø·ªúNG TR·∫¶N{RESET}!")
        time.sleep(3)
    else:
        print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
        time.sleep(3)
#defent version
def read_versions():
    if not VERSION_FILE.exists():
        return {} 
    with open(VERSION_FILE, "r", encoding="utf-8") as f:
        lines = f.readlines()
    versions = {}
    for line in lines:
        try:
            version, status = line.strip().split(": ")
            versions[version] = status
        except ValueError:
            pass
    return versions
def write_versions(versions):
    with open(VERSION_FILE, "w", encoding="utf-8") as f:
        for version, status in versions.items():
            f.write(f"{version}: {status}\n")
def check_update():
    versions = read_versions()
    if CURRENT_VERSION not in versions:
        versions[CURRENT_VERSION] = "ch∆∞a c·∫≠p nh·∫≠t th√¥ng tin"
        write_versions(versions)
    for version, status in versions.items():
        if status == "ch∆∞a c·∫≠p nh·∫≠t th√¥ng tin":
            banner(version)
            return
# define ch·ª©c nƒÉng
def facebook_all():
    tran_profiles, pilot_profiles = lay_data()
    drivers = []
    for profile, password in tran_profiles.items():
        driver, profile_path = quan_li(profile, password, "TRAN", None)
        drivers.append(driver)
    for pilot_name, data in pilot_profiles.items():
        zip_file = data["zip"]
        for sub_profile, password in data["sub_profiles"].items():
            driver, profile_path = quan_li(sub_profile, password, pilot_name, zip_file)
            drivers.append(driver)
    input(f"\nNh·∫•n {RED}Enter{RESET} ƒë·ªÉ ƒë√≥ng t·∫•t c·∫£ tr√¨nh duy·ªát...")
    for driver in drivers:
        driver.quit()
    countdown(3)
    print("ƒê√£ ƒë√≥ng t·∫•t c·∫£ tr√¨nh duy·ªát.")
def facebook():
    profile, password, environment, zip_file = chon_profile()
    driver, profile_path = quan_li(profile, password, environment, zip_file)
    os.system('cls' if os.name == 'nt' else 'clear')
    print(profile_path)
    khuyen_cao()
    input(f"\nNh·∫•n {RED}Enter{RESET} ƒë·ªÉ ƒë√≥ng tr√¨nh duy·ªát...")
    driver.quit()
    clean(profile_path)
def comment(profile=None):
    profile, password, environment, zip_file = chon_profile()
    driver, profile_path = thuc_thi(profile, password, environment, zip_file)
    driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/a').click()
    driver.find_element(By.XPATH, '/html/body/div/div/nav/div/div[2]/ul[1]/li[2]/ul/li[7]/a').click()
    os.system('cls' if os.name == 'nt' else 'clear')
    khuyen_cao()
    def cmt_post():
            global success_count
            while running:
                try:
                    time.sleep(2)
                    if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                        driver.quit()
                        break
                    noidung = [
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[1]',
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[2]',
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[3]',
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[4]',
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[5]'
                ]
                    random_xpath = random.choice(noidung)
                    try:
                        noidungjob = driver.find_element(By.XPATH, random_xpath)
                        textcomment = noidungjob.text
                    except:
                        noidungjob = driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[1]")
                        textcomment = noidungjob.text
                    driver.find_element(By.XPATH, '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[1]/div/button').click()
                    print(f'{GREEN}        I SEE {RESET} JOB {BLUE}CMT{RESET}                      ', end = '\r')
                    time.sleep(1)
                    break
                except NoSuchElementException:
                    WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, '/html/body/div/div/div[2]/div/div[2]/button'))).click()
                    print(f'{RED}        LOADING{RESET} JOB                          ', end = '\r');time.sleep(3); print('                                                        ', end = '\r')

            handles = driver.window_handles
            driver.switch_to.window(handles[1])
            try:
                driver.execute_script("window.scrollBy(0, 500);")
                driver.execute_script("window.scrollBy(0, -500);")
                driver.execute_script("window.scrollBy(0, 500);")
                driver.execute_script("window.scrollBy(0, -500);")
                driver.execute_script("window.scrollBy(0, 500);")  
                driver.execute_script("window.scrollBy(0, -500);")
                def get_comment_box():
                    try:
                        modals = driver.find_elements(By.XPATH, '//div[@role="dialog"]//div[@aria-label="ƒê√≥ng"]')
                        if modals:
                            modal = modals[0].find_element(By.XPATH, "./ancestor::div[@role='dialog']")
                            return modal.find_element(By.XPATH, './/div[@aria-label="Vi·∫øt b√¨nh lu·∫≠n"]')
                        else:
                            reels = driver.find_elements(By.XPATH, '/html/body/div[1]/div/div[1]/div/div[5]/div/div/div[3]/div[2]/div/div/div[1]/div/div[2]/div/div/div[2]/div[1]/div/div/div[2]/div[2]/div/div/div/div[4]/div/div/div/div[1]/div')
                            if reels:
                                ActionChains(driver).move_to_element(reels).click().perform()
                                return WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, driver.find_element(By.XPATH, '//div[contains(text(), "Vi·∫øt b√¨nh lu·∫≠n")]'))))
                            else:
                                return driver.find_element(By.XPATH, '//div[@aria-label="Vi·∫øt b√¨nh lu·∫≠n"]')
                    except:
                        raise Exception("L·ªói n√†y ƒë∆∞·ª£c t·∫°o ra theo y√™u c·∫ßu!")
                cmt = get_comment_box()
                try:
                    ActionChains(driver).move_to_element(cmt).click().perform()
                    countdown(5)
                    ActionChains(driver).move_to_element(cmt).click().perform()
                    ActionChains(driver).send_keys(textcomment).send_keys(Keys.ENTER).perform()
                except:
                    time.sleep(0.1)
                text_to_find = 'Gi·ªù b·∫°n ch∆∞a d√πng ƒë∆∞·ª£c t√≠nh nƒÉng n√†y'
                try:
                        WebDriverWait(driver, 2).until(EC.presence_of_element_located((By.XPATH, f"//*[contains(text(), '{text_to_find}')]")))
                        return False
                except:
                        time.sleep(0.1)
                driver.switch_to.window(handles[0])
                sodu_xpath = "/html/body/div/div/nav/div/div[2]/ul[2]/li[2]/a/strong"
                oldsodu = driver.find_element(By.XPATH, sodu_xpath)
                soducu = int(oldsodu.text.replace(",", ""))
                driver.find_element(By.XPATH, '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[1]/div/button').click()
                start_time = time.time()
                while time.time() - start_time < 5:
                            newsodu = driver.find_element(By.XPATH, sodu_xpath)
                            sodumoi = int(newsodu.text.replace(",", ""))
                            if sodumoi != soducu:  # Ngay khi s·ªë d∆∞ thay ƒë·ªïi, tho√°t v√≤ng l·∫∑p
                                break
                            time.sleep(0.1)  # Ki·ªÉm tra m·ªói 0.1 gi√¢y ƒë·ªÉ ph·∫£n ·ª©ng nhanh
                now = datetime.now()
                time_format = now.strftime("%H:%M:%S")
                if sodumoi > soducu:
                        dop = sodumoi - soducu
                        success_count += 1
                        success(success_count, time_format, dop, sodumoi, profile)
                handles = driver.window_handles
                driver.switch_to.window(handles[1])
                time.sleep(0.5)
                try:
                        driver.find_element(By.XPATH, '//div[@aria-label="Ch·ªânh s·ª≠a ho·∫∑c x√≥a b√¨nh lu·∫≠n n√†y"]').click()    
                        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, '//div[@role="menuitem"]//span[text()="X√≥a"]'))).click()
                        try:
                            WebDriverWait(driver, 1).until(EC.element_to_be_clickable((By.XPATH, "//div[@role='button'][@aria-label='X√≥a']"))).click()
                        except:
                            WebDriverWait(driver, 1).until(EC.element_to_be_clickable((By.XPATH, "//div[@role='dialog']//div[@role='button'][@aria-label='X√≥a']"))).click()
                        time.sleep(1)
                except:
                        time.sleep(0.0001)
            except:
                print(f'          [{RED}FAIL CMT{RESET}]              ', end = '\r');time.sleep(2); print('                                                        ', end = '\r') 
                time.sleep(0.001)
            return True
            
    while running:
        try:
            # check die commen 
            #if not cmt_post():
                #os.system('cls' if os.name == 'nt' else 'clear')
                #tiping('\nC·∫§U H√åNH c·ªßa b·∫°n ƒë√£ b·ªã CH·∫∂N COMMENT', delay=0.05)
                #tiping('CH√öNG T√îI r·∫•t l·∫•y l√†m ti·∫øc v·ªÅ ƒëi·ªÅu ƒë√≥ !!!!', delay=0.05)
                #tiping('-------------------------------------------', delay=0.02)
                #driver.quit()
                #print(f"\nH·ªá Th·ªëng ƒêang {GREEN}CHUY·ªÇN H∆Ø·ªöNG V·ªÄ MENU{RESET}, vui l√≤ng ch·ªù ƒë·ª£i")
                #countdown(10)
                #break
            if cmt_post():
                handles = driver.window_handles
                driver.switch_to.window(handles[1])
                driver.close()
                handles = driver.window_handles
                driver.switch_to.window(handles[0])
                try:
                    driver.find_element(By.XPATH, '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[1]/div/button').click()
                    time.sleep(1)
                except:
                    time.sleep(0.1)
                driver.refresh() 
        except:
            driver.quit()
            tiping('c√≥ m·ªôt s·ªë l·ªói trong project nh∆∞ng ch√∫ng t√¥i l∆∞·ªùi s·ª≠a l·∫Øm', delay=0.05)
            tiping('-------------------------------------------', delay=0.02)
            driver.quit()
            print(f"\nH·ªá Th·ªëng ƒêang {GREEN}KH·ªûI ƒê·ªòNG L·∫†I{RESET}, vui l√≤ng ch·ªù ƒë·ª£i")
            driver, profile_path = thuc_thi(profile, password, environment, zip_file)
            driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/a').click()
            driver.find_element(By.XPATH, '/html/body/div/div/nav/div/div[2]/ul[1]/li[2]/ul/li[7]/a').click()
            countdown(5)
            continue

def like(profile=None):
    profile, password, environment, zip_file = chon_profile()
    driver, profile_path = thuc_thi(profile, password, environment, zip_file)
    driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/a').click()
    driver.find_element(By.XPATH, '/html/body/div/div/nav/div/div[2]/ul[1]/li[2]/ul/li[2]/a').click()
    os.system('cls' if os.name == 'nt' else 'clear')
    khuyen_cao()
    def get_jobs():
        global jobs_dict
        jobs_dict.clear()
        time.sleep(2)
        index = 1
        while True:
            try:
                xpath = f"/html/body/div/div/div[2]/div/div[1]/div/div[{index}]/div/div/button"
                driver.find_element(By.XPATH, xpath)
                jobs_dict[index] = xpath
                index += 1
            except:
                break
    def like_post():
        global jobs_dict, success_count
        while running:
            handles = driver.window_handles
            if len(handles) > 1:  
                    driver.switch_to.window(handles[1])
                    if bluesea_id in AUTHORIZED_PRO_DEVICES:
                        driver.get("about:blank")
                    else:
                        driver.close()
            else:
                if bluesea_id in AUTHORIZED_PRO_DEVICES:
                    driver.execute_script("window.open('', '_blank');")
            driver.switch_to.window(handles[0])
            get_jobs()
            if not jobs_dict:
                driver.refresh()  
                print(f'{RED}        LOADING{RESET} JOB                          ', end = '\r');time.sleep(1); print('                                                        ', end = '\r')
                countdown(10)
                continue
            for job_id, job_xpath in list(jobs_dict.items()):
                handles = driver.window_handles
                if len(handles) > 1:  
                    driver.switch_to.window(handles[1])
                    if bluesea_id in AUTHORIZED_PRO_DEVICES:
                        driver.get("about:blank")
                    else:
                        driver.close()
                    time.sleep(0.5)
                else:
                    if bluesea_id in AUTHORIZED_PRO_DEVICES:
                        driver.execute_script("window.open('', '_blank');")
                driver.switch_to.window(handles[0])
                if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                    driver.quit()
                    break
                print(f'{GREEN}        I SEE{RESET} {len(jobs_dict)} JOB {BLUE}LIKE{RESET}                      ', end = '\r')
                button = driver.find_element(By.XPATH, job_xpath)
                if bluesea_id in AUTHORIZED_PRO_DEVICES:
                    link = button.get_attribute("title").strip("'")
                    driver.execute_script("""
    if (!window._originalOpen) {
        window._originalOpen = window.open;  // L∆∞u b·∫£n g·ªëc
    }
    window.open = function() { console.log('üö´ Ch·∫∑n m·ªü tab'); return null; };
""")
                    button.click()
                    driver.execute_script("window.open = window._originalOpen || window.open;")
                    time.sleep(1)
                    handles = driver.window_handles
                    if len(handles) > 1:  # Khi tab m·ªõi xu·∫•t hi·ªán
                            driver.switch_to.window(handles[1])  # Chuy·ªÉn sang tab m·ªõi
                            driver.execute_cdp_cmd("Page.addScriptToEvaluateOnNewDocument", {"source": delete_script})
                            time.sleep(1)
                            driver.get(link)  # M·ªü link mong mu·ªën
                    else:
                        continue
                else:
                    button.click()
                    time.sleep(2)
                    handles = driver.window_handles
                    driver.switch_to.window(handles[1])
                driver.execute_script("window.scrollBy(0, 500);")
                driver.execute_script("window.scrollBy(0, -500);")
                driver.execute_script("window.scrollBy(0, 500);")
                driver.execute_script("window.scrollBy(0, -500);")
                driver.execute_script("window.scrollBy(0, 500);")  
                driver.execute_script("window.scrollBy(0, -500);")
                found = False 
                try:
                    try:
                        # like
                        modal = driver.find_element(By.XPATH, '//div[@role="dialog"]//div[@aria-label="ƒê√≥ng"]').find_element(By.XPATH, "./ancestor::div[@role='dialog']")
                        like = WebDriverWait(modal, 5).until(EC.presence_of_element_located((By.XPATH, './/div[@aria-label="Th√≠ch"]')))
                    except:
                        like = driver.find_element(By.XPATH, '//div[@aria-label="Th√≠ch"]')
                    try:
                        found = True
                        ActionChains(driver).move_to_element(like).perform()
                        countdown(1)
                        ActionChains(driver).move_to_element(like).click().perform()
                        countdown(1)
                    except:
                        time.sleep(0.1)
                    if found:
                            handles = driver.window_handles
                            driver.switch_to.window(handles[0])
                            sodu_xpath = "/html/body/div[1]/div/nav/div/div[2]/ul[2]/li[2]/a/strong"
                            oldsodu = WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, sodu_xpath)))
                            soducu = int(oldsodu.text.replace(",", ""))
                            driver.find_element(By.XPATH, job_xpath).click()
                            if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                                driver.quit()
                                break
                            start_time = time.time()
                            while time.time() - start_time < 5:
                                newsodu = driver.find_element(By.XPATH, sodu_xpath)
                                sodumoi = int(newsodu.text.replace(",", ""))
                                if sodumoi != soducu:  # Ngay khi s·ªë d∆∞ thay ƒë·ªïi, tho√°t v√≤ng l·∫∑p
                                    break
                                time.sleep(0.1)  # Ki·ªÉm tra m·ªói 0.1 gi√¢y ƒë·ªÉ ph·∫£n ·ª©ng nhanh
                            now = datetime.now()
                            time_format = now.strftime("%H:%M:%S")
                            if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                                driver.quit()
                                break
                            if sodumoi > soducu:
                                dop = sodumoi - soducu
                                success_count += 1
                                success(success_count, time_format, dop, sodumoi, profile)
                            handles = driver.window_handles
                            driver.switch_to.window(handles[1])
                            text_to_find = 'Gi·ªù b·∫°n ch∆∞a d√πng ƒë∆∞·ª£c t√≠nh nƒÉng n√†y'
                            try:
                                WebDriverWait(driver, 1).until(EC.presence_of_element_located((By.XPATH, f"//*[contains(text(), '{text_to_find}')]")))
                                return False
                            except Exception as e:
                                time.sleep(0.5)
                            try:
                                ActionChains(driver).move_to_element(like).click().perform()
                            except:
                                
                                try:
                                    modal = driver.find_element(By.XPATH, '//div[@role="dialog"]//div[@aria-label="ƒê√≥ng"]').find_element(By.XPATH, "./ancestor::div[@role='dialog']")
                                    like = WebDriverWait(modal, 5).until(EC.presence_of_element_located((By.XPATH, './/div[@aria-label="Th√≠ch"]')))
                                except:
                                    like = driver.find_element(By.XPATH, '//div[@aria-label="Th√≠ch"]')
                                ActionChains(driver).move_to_element(like).click().perform()
                            print(f'          [{GREEN}PASS{RESET}]              ', end = '\r');time.sleep(2); print('                                                        ', end = '\r') 
    
                    else:
                        print(f'          [{RED}FAIL{RESET}]              ', end = '\r');time.sleep(2); print('                                                        ', end = '\r') 
            

                except Exception as e:
                    print(f'          [{RED}FAIL LIKE{RESET}]              ', end = '\r');time.sleep(2); print('                                                        ', end = '\r') 
                del jobs_dict[job_id]
    while running:
        try:
            if not like_post():
                os.system('cls' if os.name == 'nt' else 'clear')
                tiping('\nC·∫§U H√åNH c·ªßa b·∫°n ƒë√£ b·ªã CH·∫∂N LIKE', delay=0.05)
                tiping('CH√öNG T√îI r·∫•t l·∫•y l√†m ti·∫øc v·ªÅ ƒëi·ªÅu ƒë√≥ !!!!', delay=0.05)
                tiping('-------------------------------------------', delay=0.02)
                driver.quit()
                print(f"\nH·ªá Th·ªëng ƒêang {GREEN}CHUY·ªÇN H∆Ø·ªöNG V·ªÄ MENU{RESET}, vui l√≤ng ch·ªù ƒë·ª£i")
                countdown(10)
                break
            if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                driver.quit()
                break  
        except Exception as e:
            print(e)
            driver.quit()
            tiping('c√≥ m·ªôt s·ªë l·ªói trong project nh∆∞ng ch√∫ng t√¥i l∆∞·ªùi s·ª≠a l·∫Øm', delay=0.05)
            tiping('-------------------------------------------', delay=0.02)
            driver.quit()
            print(f"\nH·ªá Th·ªëng ƒêang {GREEN}KH·ªûI ƒê·ªòNG L·∫†I{RESET}, vui l√≤ng ch·ªù ƒë·ª£i")
            driver, profile_path = thuc_thi(profile, password, environment, zip_file)
            driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/a').click()
            driver.find_element(By.XPATH, '/html/body/div/div/nav/div/div[2]/ul[1]/li[2]/ul/li[2]/a').click()
            countdown(5)
            continue
def emotion():
    profile, password, environment, zip_file = chon_profile()
    driver, profile_path = thuc_thi(profile, password, environment, zip_file)
    driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/a').click()
    driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/ul/li[4]/a').click()
    os.system('cls' if os.name == 'nt' else 'clear')
    khuyen_cao()
    def get_jobs():
        global jobs_dict
        jobs_dict.clear()
        time.sleep(2)
        index = 1
        while True:
            try:
                xpath= f"/html/body/div[1]/div/div[2]/div/div[1]/div/div[{index}]/div/div/button"
                driver.find_element(By.XPATH, xpath)
                jobs_dict[index] = xpath
                index += 1
            except:
                break
    def emotion_post():
        global jobs_dict, success_count
        while running:
            handles = driver.window_handles
            if len(handles) > 1:  
                    driver.switch_to.window(handles[1])
                    driver.close()
                    time.sleep(0.5)
            driver.switch_to.window(handles[0])
            get_jobs()
            if not jobs_dict:
                driver.refresh()   
                print(f'{RED}        LOADING{RESET} JOB                          ', end = '\r');time.sleep(1); print('                                                        ', end = '\r')
                countdown(10)
                continue
            for job_id, job_xpath in list(jobs_dict.items()):
                handles = driver.window_handles
                if len(handles) > 1:  
                    driver.switch_to.window(handles[1])
                    driver.close()
                    time.sleep(0.4)
                driver.switch_to.window(handles[0])
                if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                    driver.quit()
                    break
                emotional = driver.find_element(By.XPATH, job_xpath)  
                onclick_content = emotional.get_attribute("onclick")
                # T√°ch l·∫•y lo·∫°i c·∫£m x√∫c
                reaction = onclick_content.split(",")[-1].strip()
                reaction = re.sub(r"[^A-Z√Ä-·ª∏]", "", reaction)  # Ch·ªâ gi·ªØ l·∫°i ch·ªØ c√°i
                emotional.click()
                print(f'{GREEN}        I SEE{RESET} JOB {BLUE}{reaction}{RESET}                      ', end = '\r')
                time.sleep(2)
                handles = driver.window_handles
                if len(handles) > 1:  
                    driver.switch_to.window(handles[1])
                else:
                    continue 
                if not running:
                    break
                time.sleep(0.1)
                driver.execute_script("window.scrollBy(0, 500);")
                driver.execute_script("window.scrollBy(0, -500);")
                driver.execute_script("window.scrollBy(0, 500);")
                driver.execute_script("window.scrollBy(0, -500);")
                driver.execute_script("window.scrollBy(0, 500);")  
                driver.execute_script("window.scrollBy(0, -500);")
                like_xpaths = [
        "/html/body/div[1]/div/div[1]/div/div[5]/div/div/div[2]/div/div/div/div/div/div/div/div[2]/div[2]/div/div/div/div/div/div/div/div/div/div/div/div/div[13]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]/div[1]/div[1]/span/i",  # Xpath b√¨nh th∆∞·ªùng
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[2]/div/div/div/div[1]/div/div/div[1]/div[2]/div[2]/div/div/div[1]/div/div[1]/div[1]/div[1]/span",  # Xpath video
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div/div[1]/div/div[2]/div/div/div/div[1]/div/div/div[2]/div[2]/div/div/div/div[3]/div/div/div/div[1]/div",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div[4]/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div[13]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div/div[2]/div/div/div[1]/div/div/div[2]/div[2]/div/div[1]/span/div/div/span/div[1]/div/div/span",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[2]/div/div/div/div[1]/div/div/div[1]/div[2]/div[2]/div/div/div[1]/div/div[1]/div[1]/div[1]/span/i",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div[3]/div/div/div[4]/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div[2]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[5]/div/div/div[2]/div/div/div/div/div/div/div/div[2]/div[2]/div/div/div/div/div/div/div/div/div/div/div/div/div[2]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div/div[2]/div/div/div[1]/div/div/div[2]/div[2]/div/div[1]/span/div/div/span/div[1]/div",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div/div[1]/div/div[2]/div/div/div/div[1]/div/div/div[2]/div[2]/div/div/div/div[3]/div/div/div/div[1]/div",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div[4]/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div[13]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div/div[1]/div/div/div/div/div/div[1]/div/div/div[2]/div[2]/div/div/div/div[3]/div/div",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div[2]/div/div/div[4]/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div[13]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div[2]/div/div/div/div[1]/div[2]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div[2]/div/div/div[4]/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div[13]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div/div[4]/div[2]/div/div[2]/div[2]/div[1]/div/div/div/div/div/div/div/div/div/div/div/div[13]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div[2]/div/div/div/div[1]/div[3]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div[2]/div/div[2]/div[1]/div[3]/div/div/div/div/div[1]/div/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div[4]/div/div/div/div/div/div/div/div[2]/div/div/div/div/div/div/div/div/div/div/div[13]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div/div[1]/div[2]/div/div/div/div[4]/div/div/div[2]/div/div",
        "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div[2]/div/div/div[4]/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div/div[2]/div/div/div[4]/div/div/div[1]/div/div[2]/div/div[1]/div[1]"
    ]
                found = False
                try:
                    for xpath in like_xpaths:
                        try:
                            element = driver.find_element(By.XPATH, xpath)
                            found = True
                            actions = ActionChains(driver)
                            actions.move_to_element(element).perform()
                            countdown(5)
                            mapped_reaction = reaction_map.get(reaction)
                            if mapped_reaction:
                                try:
                                    reaction_button = driver.find_element(By.XPATH, f'//div[@aria-label="{mapped_reaction}"]')
                                    reaction_button.click()
                                except:
                                    time.sleep(0.1)
                            time.sleep(0.7)
                            break
                        except:
                            continue
                    if found:
                        handles = driver.window_handles
                        driver.switch_to.window(handles[0])
                        sodu_xpath = "/html/body/div[1]/div/nav/div/div[2]/ul[2]/li[2]/a/strong"
                        oldsodu = WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, sodu_xpath)))
                        soducu = int(oldsodu.text.replace(",", ""))
                        driver.find_element(By.XPATH, job_xpath).click()
                        if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                            driver.quit()
                            break
                        start_time = time.time()
                        while time.time() - start_time < 5:
                            newsodu = driver.find_element(By.XPATH, sodu_xpath)
                            sodumoi = int(newsodu.text.replace(",", ""))
                            if sodumoi != soducu:  # Ngay khi s·ªë d∆∞ thay ƒë·ªïi, tho√°t v√≤ng l·∫∑p
                                break
                            time.sleep(0.1)  # Ki·ªÉm tra m·ªói 0.1 gi√¢y ƒë·ªÉ ph·∫£n ·ª©ng nhanh
                        now = datetime.now()
                        time_format = now.strftime("%H:%M:%S")
                        if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                            driver.quit()
                            break
                        if sodumoi > soducu:
                            dop = sodumoi - soducu
                            success_count += 1
                            success(success_count, time_format, dop, sodumoi)
                    
                        handles = driver.window_handles
                        driver.switch_to.window(handles[1])
                        text_to_find = 'Gi·ªù b·∫°n ch∆∞a d√πng ƒë∆∞·ª£c t√≠nh nƒÉng n√†y'
                        try:
                            WebDriverWait(driver, 1).until(EC.presence_of_element_located((By.XPATH, f"//*[contains(text(), '{text_to_find}')]")))
                            return False
                        except Exception as e:
                            time.sleep(0.2)
                            for xpath in like_xpaths:
                                try:
                                    like_button = driver.find_element(By.XPATH, xpath)
                                    like_button.click()
                                    time.sleep(2)
                                    break
                                except:
                                    continue
                    else:
                        driver.switch_to.window(handles[0])
                        emotional.click()
                        time.sleep(2)
                        print(f'          [{RED}FAIL LIKE{RESET}]              ', end = '\r');time.sleep(2); print('                                                        ', end = '\r') 
                    if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                        driver.quit()
                        break
                except Exception as e:
                    continue
                del jobs_dict[job_id]
    while running:
        try:
            if not emotion_post():
                os.system('cls' if os.name == 'nt' else 'clear')
                tiping('\nC·∫§U H√åNH c·ªßa b·∫°n ƒë√£ b·ªã CH·∫∂N LIKE', delay=0.05)
                tiping('CH√öNG T√îI r·∫•t l·∫•y l√†m ti·∫øc v·ªÅ ƒëi·ªÅu ƒë√≥ !!!!', delay=0.05)
                tiping('-------------------------------------------', delay=0.02)
                driver.quit()
                print(f"\nH·ªá Th·ªëng ƒêang {GREEN}CHUY·ªÇN H∆Ø·ªöNG V·ªÄ MENU{RESET}, vui l√≤ng ch·ªù ƒë·ª£i")
                countdown(10)
                break
            if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                driver.quit()
                break  
        except:
            driver.quit()
            tiping('c√≥ m·ªôt s·ªë l·ªói trong project nh∆∞ng ch√∫ng t√¥i l∆∞·ªùi s·ª≠a l·∫Øm', delay=0.05)
            tiping('-------------------------------------------', delay=0.02)
            driver.quit()
            print(f"\nH·ªá Th·ªëng ƒêang {GREEN}KH·ªûI ƒê·ªòNG L·∫†I{RESET}, vui l√≤ng ch·ªù ƒë·ª£i")
            driver, profile_path = thuc_thi(profile, password, environment, zip_file)
            driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/a').click()
            driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/ul/li[4]/a').click()
            countdown(5)
            continue
def smart_care(profile=None):
    tran_profiles, pilot_profiles = lay_data()
    print(f"\n=== M√îI TR∆Ø·ªúNG {RED}TR·∫¶N{RESET} ===")
    for i, (profile, password) in enumerate(tran_profiles.items(), start=1):
        print(f"[{YELLOW}{i}{RESET}] {profile}")
    index_offset = len(tran_profiles) + 1
    pilot_index_map = {}
    if pilot_profiles:
        for pilot_name, data in pilot_profiles.items():
            zip_file = data.get("zip")
            zip_name = os.path.basename(zip_file) if zip_file else "Kh√¥ng c√≥ ZIP"
            print(f"=== {GREEN}{pilot_name}{RESET} ({zip_name}) ===")
            for sub_profile, password in data["sub_profiles"].items():
                print(f"[{YELLOW}{index_offset}{RESET}] {sub_profile}")
                pilot_index_map[index_offset] = (pilot_name, sub_profile)
                index_offset += 1
    choice = int(input())
    if choice in range(1, len(tran_profiles) + 1):
        profile = list(tran_profiles.keys())[choice - 1]
        password = tran_profiles[profile]
        environment = "TRAN"
        zip_file = None
    elif choice in pilot_index_map:
        pilot_name, profile = pilot_index_map[choice]
        password = pilot_profiles[pilot_name]["sub_profiles"][profile]
        environment = pilot_name
        zip_file = pilot_profiles[pilot_name].get("zip")
    else:
        print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
        time.sleep(3)
        return
    driver = care(profile, password, environment, zip_file)
    def feed(driver, duration=60):
        start_time = time.time()
        end_time = start_time + duration  
        with Progress() as progress:
            task = progress.add_task("[RED] ƒêang ch·∫°y...", total=duration)
            while time.time() < end_time:
                try:
                    driver.find_element(By.XPATH, '/html/body/div[1]/div/div[1]/div/div[2]/div[4]/div/div[1]/div[1]/ul/li[1]/span/div/a').click()
                    time.sleep(1.5)
                except Exception:
                    print("Kh√¥ng v√†o ƒë∆∞·ª£c News Feed")
                scroll_height = random.randint(300, 800)
                driver.execute_script(f"window.scrollBy(0, {scroll_height});")
                if random.random() < 0.1: 
                    like_xpath = "/html/body/div[1]/div/div[1]/div/div[3]/div/div/div[1]/div[1]/div/div[2]/div/div/div/div[2]/div/div[4]/div/div[2]/div[1]/div/div/div/div/div/div/div/div/div/div/div/div/div/div[13]/div/div/div[4]/div/div/div/div/div[2]/div/div[1]/div[1]"
                    try:
                        like_button = driver.find_element(By.XPATH, like_xpath)
                        like_button.click()
                        print("ƒê√£ nh·∫•n Like")
                        time.sleep(random.uniform(2, 5))
                    except:
                        print("Kh√¥ng t√¨m th·∫•y n√∫t Like")
                progress.update(task, advance=random.uniform(5, 10))
                if time.time() >= end_time:
                    break  
                time.sleep(random.uniform(5, 10))  
    countdown(10)
    feed(driver, duration=120)
    print("‚úÖ ƒê√£ ho√†n th√†nh 1 phi√™n feed.") 
    input()
    driver.quit()
    os.system('cls' if os.name == 'nt' else 'clear')
    khuyen_cao()
def da_luong():
    bill = 0
    tran_profiles, pilot_profiles = lay_data()
    selected_profiles = []  
    while True:
        os.system('cls' if os.name == 'nt' else 'clear')
        print("=== DANH S√ÅCH C·∫§U H√åNH ƒê√É CH·ªåN ===")
        if selected_profiles:
            for profile, environment in selected_profiles:
                print(f"- {RED}{profile} ({environment}){RESET}")
        else:
            print(f"{YELLOW}Ch∆∞a c√≥ c·∫•u h√¨nh n√†o ƒë∆∞·ª£c ch·ªçn!{RESET}")

        print("\n=== DANH S√ÅCH C·∫§U H√åNH CH∆ØA CH·ªåN ===")
        profile_index_map = {} 
        print(f"\n{BLUE}--- M√îI TR∆Ø·ªúNG TR·∫¶N ---{RESET}")
        index = 1
        for profile, password in tran_profiles.items():
            if (profile, "TRAN") not in selected_profiles:
                print(f"[{index}] {profile}")
                profile_index_map[index] = (profile, password, "TRAN", None)
                index += 1

        # Hi·ªÉn th·ªã c√°c profile PILOT
        if pilot_profiles:
            for pilot_name, data in pilot_profiles.items():
                zip_file = data.get("zip")
                zip_name = os.path.basename(zip_file) if zip_file else "Kh√¥ng c√≥ ZIP"
                print(f"\n{GREEN}--- {pilot_name} ({zip_name}) ---{RESET}")
                for sub_profile, password in data["sub_profiles"].items():
                    if (sub_profile, pilot_name) not in selected_profiles:
                        print(f"[{index}] {sub_profile}")
                        profile_index_map[index] = (sub_profile, password, pilot_name, zip_file)
                        index += 1
        cauhinh = input(f"\nCh·ªçn {GREEN}C·∫§U H√åNH{RESET} (ho·∫∑c X ƒë·ªÉ ho√†n t·∫•t): ").strip().upper()

        # X·ª≠ l√Ω l·ª±a ch·ªçn
        if cauhinh.isdigit() and int(cauhinh) in profile_index_map:
            selected_profile = profile_index_map[int(cauhinh)]
            profile_name, _, environment, _ = selected_profile
            if (profile_name, environment) not in selected_profiles:
                selected_profiles.append((profile_name, environment))
        elif cauhinh == "X":
            break
        else:
            print(f"{RED}L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá, vui l√≤ng th·ª≠ l·∫°i!{RESET}")
            time.sleep(2)
    drivers = {}
    for i, (profile, environment) in enumerate(selected_profiles, start=1):
        password = None
        zip_file = None
        if environment == "TRAN":
            password = tran_profiles[profile]
        else:
            for pilot_name, data in pilot_profiles.items():
                if pilot_name == environment and profile in data["sub_profiles"]:
                    password = data["sub_profiles"][profile]
                    zip_file = data.get("zip")
                    break
        # Kh·ªüi t·∫°o driver
        driver_name = f"driver{i}"
        drivers[driver_name] = thuc_thi(profile, password, environment, zip_file)
        driver = drivers[driver_name]  # G√°n driver t·ª´ dictionary

        driver.find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/a').click()
        driver.find_element(By.XPATH, '/html/body/div/div/nav/div/div[2]/ul[1]/li[2]/ul/li[7]/a').click()
        if not running:
            driver.quit()
            break
        time.sleep(2)
        sodu = drivers[driver_name].find_element(By.XPATH, '/html/body/div/div/nav/div/div[2]/ul[2]/li[2]/a/strong')
        bill += int(sodu.text.replace(",", ""))
        print(f"C·∫•u h√¨nh {RED}{profile} {GREEN}S·∫¥N S√ÄNG{RESET} v·ªõi s·ªë d∆∞: {YELLOW}{bill}{RESET}")
    khuyen_cao()
    drivers_list = list(drivers.values())
    khuyen_cao()
    def cmt_post(driver):
            global success_count
            while running:
                try:
                    time.sleep(2)
                    if not running:  # Ki·ªÉm tra n·∫øu c·∫ßn d·ª´ng
                        driver.quit()
                        break
                    noidung = [
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[1]',
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[2]',
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[3]',
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[4]',
                    '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[5]'
                ]
                    random_xpath = random.choice(noidung)
                    try:
                        noidungjob = driver.find_element(By.XPATH, random_xpath)
                        textcomment = noidungjob.text
                    except:
                        noidungjob = driver.find_element(By.XPATH, "/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[2]/div[2]/ul/textarea[1]")
                        textcomment = noidungjob.text
                    driver.find_element(By.XPATH, '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[1]/div/button').click()
                    print(f'{GREEN}        I SEE {RESET} JOB {BLUE}CMT{RESET}                      ', end = '\r')
                    time.sleep(1)
                    break
                except NoSuchElementException:
                    WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, '/html/body/div/div/div[2]/div/div[2]/button'))).click()
                    print(f'{RED}        LOADING{RESET} JOB                          ', end = '\r');time.sleep(3); print('                                                        ', end = '\r')

            handles = driver.window_handles
            driver.switch_to.window(handles[1])
            try:
                driver.execute_script("window.scrollBy(0, 500);")
                driver.execute_script("window.scrollBy(0, -500);")
                driver.execute_script("window.scrollBy(0, 500);")
                driver.execute_script("window.scrollBy(0, -500);")
                driver.execute_script("window.scrollBy(0, 500);")  
                driver.execute_script("window.scrollBy(0, -500);")
                def get_comment_box():
                    try:
                        modals = driver.find_elements(By.XPATH, '//div[@role="dialog"]//div[@aria-label="ƒê√≥ng"]')
                        if modals:
                            modal = modals[0].find_element(By.XPATH, "./ancestor::div[@role='dialog']")
                            return modal.find_element(By.XPATH, './/div[@aria-label="Vi·∫øt b√¨nh lu·∫≠n"]')
                        else:
                            reels = driver.find_elements(By.XPATH, './/div[@aria-label="B√¨nh lu·∫≠n"]')
                            if reels:
                                ActionChains(driver).move_to_element(reels).click().perform()
                                return WebDriverWait(driver, 10).until(EC.presence_of_element_located((By.XPATH, driver.find_element(By.XPATH, '//div[contains(text(), "Vi·∫øt b√¨nh lu·∫≠n")]'))))
                            else:
                                return driver.find_element(By.XPATH, '//div[@aria-label="Vi·∫øt b√¨nh lu·∫≠n"]')
                    except:
                        raise Exception("L·ªói n√†y ƒë∆∞·ª£c t·∫°o ra theo y√™u c·∫ßu!")
                cmt = get_comment_box()
                try:
                    ActionChains(driver).move_to_element(cmt).click().perform()
                    countdown(5)
                    ActionChains(driver).move_to_element(cmt).click().perform()
                    ActionChains(driver).send_keys(textcomment).send_keys(Keys.ENTER).perform()
                except:
                    time.sleep(0.1)
                text_to_find = 'Gi·ªù b·∫°n ch∆∞a d√πng ƒë∆∞·ª£c t√≠nh nƒÉng n√†y'
                try:
                        WebDriverWait(driver, 2).until(EC.presence_of_element_located((By.XPATH, f"//*[contains(text(), '{text_to_find}')]")))
                        return False
                except:
                        time.sleep(0.1)
                driver.switch_to.window(handles[0])
                sodu_xpath = "/html/body/div/div/nav/div/div[2]/ul[2]/li[2]/a/strong"
                oldsodu = driver.find_element(By.XPATH, sodu_xpath)
                soducu = int(oldsodu.text.replace(",", ""))
                driver.find_element(By.XPATH, '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[1]/div/button').click()
                start_time = time.time()
                while time.time() - start_time < 5:
                            newsodu = driver.find_element(By.XPATH, sodu_xpath)
                            sodumoi = int(newsodu.text.replace(",", ""))
                            if sodumoi != soducu:  # Ngay khi s·ªë d∆∞ thay ƒë·ªïi, tho√°t v√≤ng l·∫∑p
                                break
                            time.sleep(0.1)  # Ki·ªÉm tra m·ªói 0.1 gi√¢y ƒë·ªÉ ph·∫£n ·ª©ng nhanh
                now = datetime.now()
                time_format = now.strftime("%H:%M:%S")
                if sodumoi > soducu:
                        dop = sodumoi - soducu
                        success_count += 1
                        sodu = bill + dop
                        print(f"[{success_count}]{RED}{time_format}{RESET}|B·∫†N ƒê√É ƒê·ªöP{YELLOW}|>{dop}<|{RESET}S·ªê D∆Ø: {YELLOW}{sodu}{RESET}|")
                        bill = sodu 
                handles = driver.window_handles
                driver.switch_to.window(handles[1])
                time.sleep(0.5)
                try:
                        driver.find_element(By.XPATH, '//div[@aria-label="Ch·ªânh s·ª≠a ho·∫∑c x√≥a b√¨nh lu·∫≠n n√†y"]').click()    
                        WebDriverWait(driver, 10).until(EC.element_to_be_clickable((By.XPATH, '//div[@role="menuitem"]//span[text()="X√≥a"]'))).click()
                        try:
                            WebDriverWait(driver, 1).until(EC.element_to_be_clickable((By.XPATH, "//div[@role='button'][@aria-label='X√≥a']"))).click()
                        except:
                            WebDriverWait(driver, 1).until(EC.element_to_be_clickable((By.XPATH, "//div[@role='dialog']//div[@role='button'][@aria-label='X√≥a']"))).click()
                        time.sleep(1)
                except:
                        time.sleep(0.0001)
            except:
                print(f'          [{RED}FAIL CMT{RESET}]              ', end = '\r');time.sleep(2); print('                                                        ', end = '\r') 
                time.sleep(0.001)
            return True
    def main(driver):
        global running
        while running:
            try:
                if not cmt_post(driver):
                    driver.quit()
                    break
                else:
                    handles = driver.window_handles
                    driver.switch_to.window(handles[1])
                    driver.close()
                    handles = driver.window_handles
                    driver.switch_to.window(handles[0])
                    try:
                        driver.find_element(By.XPATH, '/html/body/div/div/div[2]/div/div[1]/div/div[1]/div[1]/div/button').click()
                        time.sleep(1)
                    except:
                        time.sleep(0.1)
                    driver.refresh() 
            except:
                driver.quit()
                time.sleep(10)
                driver = thuc_thi(profile, password, environment, zip_file)
                drivers[driver_name] = thuc_thi(profile, password, environment, zip_file)
                drivers[driver_name].find_element(By.XPATH, '/html/body/div[1]/div/nav/div/div[2]/ul[1]/li[2]/a').click()
                drivers[driver_name].find_element(By.XPATH, '/html/body/div/div/nav/div/div[2]/ul[1]/li[2]/ul/li[7]/a').click()
                countdown(5)
                continue
            
    thread_list = []
    for driver in drivers_list:
        thread = threading.Thread(target=main, args=(driver,))
        thread.start()
        thread_list.append(thread)
    for thread in thread_list:
        thread.join()




# define hi·ªÉn th·ªã
def chon_profile():
    """
    L·∫•y d·ªØ li·ªáu t·ª´ `lay_data()`, s·∫Øp x·∫øp danh s√°ch profile theo th·ª© t·ª±, 
    hi·ªÉn th·ªã danh s√°ch profile v√† cho ph√©p ng∆∞·ªùi d√πng ch·ªçn.
    """
    def thu_tu(danh_sach):
        """S·∫Øp x·∫øp danh s√°ch theo s·ªë th·ª© t·ª± ·ªü cu·ªëi, n·∫øu kh√¥ng c√≥ s·ªë th√¨ s·∫Øp x·∫øp theo ch·ªØ c√°i."""
        def extract_key(profile):
            match = re.search(r'(\d+)$', profile)  # T√¨m s·ªë ·ªü cu·ªëi
            return (int(match.group(1)) if match else float('inf'), profile)

        return sorted(danh_sach, key=extract_key)

    # L·∫•y d·ªØ li·ªáu t·ª´ `lay_data()`
    tran_profiles, pilot_profiles = lay_data()

    # S·∫Øp x·∫øp danh s√°ch TRAN
    danh_sach_tran = thu_tu(list(tran_profiles.keys()))

    print(f"\n=== M√îI TR∆Ø·ªúNG {RED}TR·∫¶N{RESET} ===")
    for i, profile in enumerate(danh_sach_tran, start=1):
        print(f"[{YELLOW}{i}{RESET}] {profile}")

    index_offset = len(danh_sach_tran) + 1
    pilot_index_map = {}

    if pilot_profiles:
        for pilot_name, data in pilot_profiles.items():
            zip_file = data.get("zip")
            zip_name = os.path.basename(zip_file) if zip_file else "Kh√¥ng c√≥ ZIP"
            print(f"=== {GREEN}{pilot_name}{RESET} ({zip_name}) ===")

            danh_sach_pilot = thu_tu(list(data["sub_profiles"].keys()))

            for sub_profile in danh_sach_pilot:
                print(f"[{YELLOW}{index_offset}{RESET}] {sub_profile}")
                pilot_index_map[index_offset] = (pilot_name, sub_profile)
                index_offset += 1

    try:
        choice = int(input("         [X] ƒë·ªÉ quay v·ªÅ menu ch√≠nh: " ))
    except ValueError:
        return None, None, None, None

    if choice in range(1, len(danh_sach_tran) + 1):
        profile = danh_sach_tran[choice - 1]
        password = tran_profiles[profile]
        environment = "TRAN"
        zip_file = None
    elif choice in pilot_index_map:
        pilot_name, profile = pilot_index_map[choice]
        password = pilot_profiles[pilot_name]["sub_profiles"][profile]
        environment = pilot_name
        zip_file = pilot_profiles[pilot_name].get("zip")
    else:
        print(f"{RED}L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá!{RESET}")
        time.sleep(3)
        return None, None, None, None

    return profile, password, environment, zip_file
def banner():
    os.system('cls' if os.name == 'nt' else 'clear')
    time.sleep(2)
    tiping(f"\n=== BLUESEA PROJECT _3.BETA ===", delay=0.05)
    time.sleep(2)
    os.system('cls' if os.name == 'nt' else 'clear')
    time.sleep(2)
    print(f"\n=== {BLUE}BLUESEA PROJECT{RESET}_2.Trial ===")
    tiping(f"   m·ªôt phi√™n b·∫£n mang kh√° nhi·ªÅu sai s√≥t v·ªÅ v·∫•n ƒë·ªÅ PROXY ( IP ) v·ªõi s·ªë l∆∞·ª£ng l·ªõn C·∫§U H√åNH", delay=0.05)
    time.sleep(2)
    os.system('cls' if os.name == 'nt' else 'clear')
    nhapnhay(f"V·∫¨Y!  'PROXY'  l√† g√¨ ?", times=3)
    time.sleep(2)
    proxy_explanation = """
    PROXY ( M√ÅY CH·ª¶ TRUNG GIAN )
    L√Ä m·ªôt h·ªá th·ªëng ho·∫∑c m√°y ch·ªß ho·∫°t ƒë·ªông nh∆∞ m·ªôt "c·∫ßu n·ªëi" gi·ªØa ng∆∞·ªùi d√πng v√† Internet. 
    Khi b·∫°n truy c·∫≠p m·ªôt trang web th√¥ng qua proxy 
    thay v√¨ k·∫øt n·ªëi tr·ª±c ti·∫øp, y√™u c·∫ßu c·ªßa b·∫°n s·∫Ω ƒëi qua proxy tr∆∞·ªõc, r·ªìi m·ªõi ƒë·∫øn trang web ƒë√≠ch.

    C√ÅCH HO·∫†T ƒê·ªòNG C·ª¶A PROXY ƒê·ªêI V·ªöI PROJECT:
   1. khi b·∫°n s·ª≠ d·ª•ng PROJECT ‚Üí HO·∫†T ƒê·ªòNG c·ªßa PROJECT ƒë∆∞·ª£c g·ª≠i ƒë·∫øn m√°y ch·ªß proxy.
   2. Proxy thay m·∫∑t PROJECT g·ª≠i y√™u c·∫ßu ‚Üí M√°y ch·ªß proxy nh·∫≠n y√™u c·∫ßu v√† chuy·ªÉn ti·∫øp n√≥ ƒë·∫øn trang web ƒë√≠ch.
   3. Nh·∫≠n ph·∫£n h·ªìi ‚Üí Trang web ƒë√≠ch ph·∫£n h·ªìi l·∫°i v·ªõi proxy, r·ªìi proxy g·ª≠i d·ªØ li·ªáu ƒë√≥ v·ªÅ PROJECT.

    L·ª¢I √çCH C·ª¶A PROXY:
   - ·∫®n ƒë·ªãa ch·ªâ IP TR·∫¶N, tƒÉng c∆∞·ªùng quy·ªÅn ri√™ng t∆∞.
   - V∆∞·ª£t qua gi·ªõi h·∫°n truy c·∫≠p n·ªôi dung b·ªã ch·∫∑n.
   - C·∫£i thi·ªán b·∫£o m·∫≠t khi duy·ªát web.
   - TƒÉng t·ªëc ƒë·ªô truy c·∫≠p b·∫±ng b·ªô nh·ªõ ƒë·ªám (caching).


    T√ÅC D·ª§NG C·ª¶A PROXY ƒê·ªêI V·ªöI C·∫§U H√åNH:
    Khi qu·∫£n l√Ω nhi·ªÅu t√†i kho·∫£n Facebook, vi·ªác s·ª≠ d·ª•ng proxy l√† r·∫•t quan tr·ªçng v√¨:

    ---Tr√°nh b·ªã ph√°t hi·ªán v√† kh√≥a t√†i kho·∫£n:  
      - Facebook c√≥ c∆° ch·∫ø ph√°t hi·ªán n·∫øu nhi·ªÅu t√†i kho·∫£n ƒëƒÉng nh·∫≠p t·ª´ c√πng m·ªôt ƒë·ªãa ch·ªâ IP, d·ªÖ b·ªã ƒë√°nh d·∫•u l√† "h√†nh vi ƒë√°ng ng·ªù" v√† c√≥ th·ªÉ b·ªã kh√≥a.  
      - S·ª≠ d·ª•ng proxy gi√∫p m·ªói t√†i kho·∫£n c√≥ m·ªôt IP kh√°c nhau, gi·ªëng nh∆∞ ch√∫ng ƒë∆∞·ª£c ƒëƒÉng nh·∫≠p t·ª´ c√°c v·ªã tr√≠ kh√°c nhau.

    ---H·∫°n ch·∫ø checkpoint (X√°c minh danh t√≠nh, 282, 956):  
      - N·∫øu Facebook th·∫•y c√≥ nhi·ªÅu t√†i kho·∫£n c√πng ƒëƒÉng nh·∫≠p t·ª´ m·ªôt ƒë·ªãa ch·ªâ, n√≥ c√≥ th·ªÉ y√™u c·∫ßu x√°c minh danh t√≠nh.  
      - D√πng proxy gi√∫p t·∫°o m√¥i tr∆∞·ªùng ƒëƒÉng nh·∫≠p t·ª± nhi√™n h∆°n.

    ---Qu·∫£n l√Ω t√†i kho·∫£n d·ªÖ d√†ng h∆°n:  
      - C√≥ th·ªÉ d√πng c√°c lo·∫°i Proxy ƒë·ªÉ gi·∫£ l·∫≠p v·ªã tr√≠ c·ªßa t·ª´ng t√†i kho·∫£n.  

    ---TƒÉng hi·ªáu qu·∫£ khi S·ª¨ D·ª§NG C·∫§U H√åNH:
      - Khi qu·∫£n l√Ω nhi·ªÅu t√†i kho·∫£n ƒë·ªÉ s·ª≠ d·ª•ng project, tr√°nh b·ªã Facebook g·∫Øn c·ªù l√† "PH√ÅT HI·ªÜN T·ª∞ ƒê·ªòNG HO√Å".  
      - Proxy gi√∫p t·∫°o ra m·∫°ng l∆∞·ªõi t√†i kho·∫£n s·∫°ch, h·∫°n ch·∫ø b·ªã ƒë√°nh d·∫•u l√† spam.

    ! L∆∞u √Ω khi s·ª≠ d·ª•ng proxy ƒë·ªÉ qu·∫£n l√Ω nhi·ªÅu t√†i kho·∫£n Facebook:  
      - Kh√¥ng n√™n s·ª≠ d·ª•ng c√°c proxy c√¥ng khai mi·ªÖn ph√≠ v√¨ c√≥ th·ªÉ b·ªã Facebook ƒë√°nh d·∫•u.  
      - N√™n d√πng proxy c√≥ ch·∫•t l∆∞·ª£ng t·ªët, ∆∞u ti√™n ƒê·∫∂T MUA T·∫†I ADMIN ƒë·ªÉ gi·∫£m r·ªßi ro.  
    """
    time.sleep(2)
    tiping((proxy_explanation), delay=0.08)
    input(f"\nNh·∫•n {RED}Enter{RESET} ƒë·ªÉ ti·∫øp t·ª•c...")
    os.system('cls' if os.name == 'nt' else 'clear')
    time.sleep(2)
    print(f"        C√ÅC T√çNH NƒÇNG {GREEN}M·ªöI N·ªîI B·∫¨T{RESET}")
    proxy_explanation = """
    ·ªû phi√™n b·∫£n m·ªõi n√†y, ch√∫ng t√¥i mang ƒë·∫øn m·ªôt h·ªá th·ªëng qu·∫£n l√≠ m√¥i tr∆∞·ªùng c·ª±c k√¨ m·ªõi mang t√™n PROXY PILOT
    ---H·ªÜ M√îI TR∆Ø·ªúNG M·ªöI TRONG PROJECT:
    -M√îI TR∆Ø·ªúNG 'TR·∫¶N':
      L√† lo·∫°i m√¥i tr∆∞·ªùng s·ª≠ d·ª•ng IP g·ªëc c·ªßa m√°y t√≠nh, kh√¥ng s·ª≠ d·ª•ng proxy.
      L√† lo·∫°i m√¥i tr∆∞·ªùng m·∫∑c ƒë·ªãnh khi b·∫°n th√™m m·ªôt c·∫•u h√¨nh m·ªõi

    -M√îI TR∆Ø·ªúNG 'PILOT (PROXY PILOT)':
        L√† lo·∫°i m√¥i tr∆∞·ªùng s·ª≠ d·ª•ng proxy, gi√∫p t·∫°o ra m√¥i tr∆∞·ªùng ƒëƒÉng nh·∫≠p t·ª± nhi√™n h∆°n.
        M·ªói m√¥i tr∆∞·ªùng PILOT ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng s·∫Ω c√≥ t√™n ƒë·∫∑t ri√™ng v√† m·ªôt IP proxy c·ªë ƒë·ªãnh
        M·ªói m√¥i tr∆∞·ªùng PILOT ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng ch·ªâ qu·∫£n l√≠ t·ªëi ƒëa '3' C·∫§U H√åNH
    
    -PROJECT h·ªó tr·ª£ ng∆∞·ªùi d√πng:
      -T·∫†O v√† QU·∫¢N L√ç m√¥i tr∆∞·ªùng PROXY PILOT
      -CHUY·ªÇN ƒê·ªîI qua l·∫°i C·∫§U H√åNH gi·ªØa m√¥i tr∆∞·ªùng TR·∫¶N v√† m√¥i tr∆∞·ªùng PILOT
    """
    tiping((proxy_explanation), delay=0.08)
    input(f"\nNh·∫•n {RED}Enter{RESET} ƒë·ªÉ ti·∫øp t·ª•c...")
    os.system('cls' if os.name == 'nt' else 'clear')
    time.sleep(2)
    tiping(("\nƒê·ªÇ cho b·∫°n d·ªÖ h√¨nh dung th√¨ ƒë√¢y l√† m√¥ ph·ªèng l·∫°i 2 lo·∫°i M√îI TR∆Ø·ªúNG"), delay=0.08)
    tiping("\nüìÇ C∆° s·ªü d·ªØ li·ªáu PROJECT", delay=0.08)

    # In m√¥i tr∆∞·ªùng TRAN
    tiping(" ‚îú‚îÄ‚îÄ üìÇ TRAN (M√¥i tr∆∞·ªùng tr·∫ßn - H·ªì s∆° ƒë·ªôc l·∫≠p)", delay=0.08)
    tran_profiles = ["C·∫§U H√åNH 1", "C·∫§U H√åNH 2", "C·∫§U H√åNH 3"] 
    for profile in tran_profiles:
        tiping(f" ‚îÇ    ‚îú‚îÄ‚îÄ üóÇ {profile}  (Kh√¥ng c√≥ proxy)", delay=0.08)

    # In m√¥i tr∆∞·ªùng PILOT
    tiping(" ‚îú‚îÄ‚îÄ üìÇ PILOT (M√¥i tr∆∞·ªùng pilot - C√≥ Proxy)", delay=0.08)
    pilot_envs = {
        "Pilot_A": ["C·∫§U H√åNH 4", "C·∫§U H√åNH 5", "C·∫§U H√åNH 6"],
        "Pilot_B": ["C·∫§U H√åNH 7", "C·∫§U H√åNH 8"],
        "Pilot_C": ["C·∫§U H√åNH 9", "C·∫§U H√åNH 10"]
    }

    index = 0
    for pilot, sub_profiles in pilot_envs.items():
        tiping(f" ‚îÇ    ‚îú‚îÄ‚îÄ üìÇ {pilot}  (D√πng Proxy {index + 1})", delay=0.08)
        for sub_profile in sub_profiles:
            tiping(f" ‚îÇ    ‚îÇ    ‚îú‚îÄ‚îÄ üóÇ {sub_profile}", delay=0.08)
        index += 1



    input(f"\nNh·∫•n {RED}Enter{RESET} ƒë·ªÉ ti·∫øp t·ª•c...")
    os.system('cls' if os.name == 'nt' else 'clear')
    tiping(f"\nCH√öNG T√îI S·∫º S·ªöM C√ì B·∫¢N C·∫¨P NH·∫¨T HO√ÄN CH·ªàNH H∆†N TRONG TH·ªúI GIAN S·∫ÆP T·ªöI", delay=0.05)
    tiping(f"B·∫†N ƒê√É C√ì TH·ªÇ TR·∫¢I NGHI·ªÜM PROXY PILOT ·ªü PH·∫¶N CH·ªàNH S·ª¨A C·∫§U H√åNH", delay=0.05)
    tiping(f"C·∫¢M ∆†N V√å ƒê√É TR·∫¢I NGHI·ªÜM PROJECT C·ª¶A CH√öNG T√îI", delay=0.05)
    print(f"\n=== {BLUE}BLUESEA PROJECT{RESET}_3 ===")
    print(f"----------copyright: HACKER NGUYEN VAN DUNGDUNG")
    print(f"   QU·∫¢N TR·ªä C·∫§U H√åNH")
    print(f"[1] M·ªû T·∫§T C·∫¢ C·∫§U H√åNH")
    print(f"[2] M·ªû CH·ªà ƒê·ªäNH C·∫§U H√åNH")
    print(f"[{YELLOW}3{RESET}] CH·ªàNH S·ª¨A C·∫§U H√åNH                {RED}<---{RESET}")
    print(f"   HO·∫†T ƒê·ªòNG C·∫§U H√åNH")  
    print(f"[4] COMMENT POST ANTI BLOCK")
    print(f"[5] LIKE POST ANTI BLOCK")
    print(f"[COMING SOON] SMATCARE")
    print(f"[COMING SOON] MUTIPLE OPITON")
    print(f"        [X] Tho√°t ch∆∞∆°ng tr√¨nh")
    countdown(10)
def tiping(text, delay):
    for char in text:
        sys.stdout.write(char)
        sys.stdout.flush()
        time.sleep(delay)
    print()  
def nhapnhay(text, times=5, delay=0.3):
    for _ in range(times):
        sys.stdout.write(f"\r{text}")
        sys.stdout.flush()
        time.sleep(delay)
        sys.stdout.write("\r" + " " * len(text))  
        sys.stdout.flush()
        time.sleep(delay)
    sys.stdout.write(f"\r{text}\n")  
def option_menu():
        os.system('cls' if os.name == 'nt' else 'clear')
        print(f"\n=== {BLUE}CH·ªàNH S·ª¨A C·∫§U H√åNH{RESET} ===")
        print(f"[{RED}1{RESET}] PROXY PILOT")
        print(f"[{RED}2{RESET}] Chuy·ªÉn ƒê·ªïi m√¥i tr∆∞·ªùng")
        print(f"[{GREEN}3{RESET}] Th√™m m·ªõi C·∫§U H√åNH")
        print(f"[{GREEN}4{RESET}] X√≥a C·∫§U H√åNH")
        choice = input("         [X] ƒë·ªÉ quay v·ªÅ menu ch√≠nh: " ).strip()
        if choice == "1":
            create_proxy()
        elif choice == "2":
            chuyen_profile()
        elif choice == "3":
            tao_profile()
        elif choice == "4":
            clear()
        elif choice == "X":
            print("Quay l·∫°i menu ch√≠nh.")
        else:
            print("L·ª±a ch·ªçn kh√¥ng h·ª£p l·ªá, vui l√≤ng th·ª≠ l·∫°i.")
def success(success_count, time_format, dop, sodumoi, profile):
    print(f"[{success_count}]{RED}{time_format}{RESET}|{profile}{YELLOW}|>+{dop}<|{RESET}S·ªê D∆Ø: {YELLOW}{sodumoi}{RESET}|")
def khuyen_cao():
    os.system('cls' if os.name == 'nt' else 'clear')
    print(f"\nNH·ªÆNG ƒêI·ªÄU C·∫¶N {YELLOW}L∆ØU √ù{RESET}")
    print(f"------------------------")
    print(f"[3] {RED}KH√îNG{RESET} ƒê√ìNG TR√åNH DUY·ªÜT TH·ª¶ C√îNG.")
    print(f"[4] {RED}KH√îNG N√äN{RESET} TI·∫æN H√ÄNH S·ª¨ D·ª§NG NGAY HO·∫†T ƒê·ªòNG C·∫§U H√åNH.")
    print(f"[1] {GREEN}C·∫¶N{RESET} ƒêƒÇNG NH·∫¨P T√ÄI KHO·∫¢N FACEBOOK ƒê·ªÇ CH·∫†Y C·∫§U H√åNH.")
    print(f"[2] {GREEN}C·∫¶N{RESET} ƒê·∫¢M B·∫¢O T√ÄI KHO·∫¢N FACEBOOK ƒê∆Ø·ª¢C ƒê·∫∂T L√ÄM NICK CH·∫†Y.")
    print(f"[3] {GREEN}C·∫¶N{RESET} ƒê·ª¢I 24-48H ƒê·ªÇ ƒê·∫¢M B·∫¢O T√ÄI KHO·∫¢N FACEBOOK ƒê∆Ø·ª¢C TIN C·∫¨Y.")
    print(f"------------------------")
    print(f"[!] {RED}HO·∫†T ƒê·ªòNG C·∫§U H√åNH{RESET} kh·∫£ d·ª•ng khi b·∫°n ƒë√£ LOGIN nick ch·∫°y ƒë√£ {GREEN}li√™n k·∫øt{RESET} v·ªõi tuongtaccheo.")
    print(f"[!] {RED}ANTI BLOCK{RESET} ƒë∆∞·ª£c ho·∫°t ƒë·ªông {YELLOW}·ªîN ƒê·ªäNH{RESET} khi t√†i kho·∫£n Facebook ƒë∆∞·ª£c {GREEN}tin c·∫≠y{RESET}")
    print(f"[!] {RED}ANTI BLOCK{RESET} ƒë∆∞·ª£c ho·∫°t ƒë·ªông {GREEN}T·ªêI ƒêA{RESET} v·ªõi nh·ªØng t√†i kho·∫£n {GREEN}VIA tin c·∫≠y{RESET}")
    print(f"T√îI s·∫Ω s·ªõm c·∫≠p nh·∫≠t gi√°o √°n s·ª≠ d·ª•ng h∆°p l√≠ Project ƒë·ªÉ tr√°nh t√¨nh tr·∫°ng kho√° >{RED}282,956...{RESET}<")
    print(f"ƒê√ÇY l√† m·ªôt PROJECT {RED}l·ªói{RESET} v√¨ ƒë∆∞·ª£c chuy·ªÉn ƒë·ªïi t·ª´ h·ªá ƒëi·ªÅu h√†nh {GREEN}MACOS{RESET}")
    print(f"N√™n khi ch·∫°y tr√™n {GREEN}windows{RESET} s·∫Ω c√≥ m·ªôt s·ªë {RED}l·ªói hi·ªÉn th·ªã nh·ªè{RESET}, T√îI ƒëang c·ªë kh·∫Øc ph·ª•c")
    print(f"^-^ ch√∫c b·∫°n 'ƒê·ªöP NG·∫¨P M·ªíM' v·ªõi {BLUE}BLUESEA PROJECT{RESET}")
    print(f"------------------------")
def countdown(duration):
    spinner = itertools.cycle(["^", "<", "v", ">"])  # Hi·ªáu ·ª©ng xoay v√≤ng
    start_time = time.time()
    
    while time.time() - start_time < duration:
        elapsed_time = time.time() - start_time
        remaining_time = duration - elapsed_time
        if remaining_time > duration * 0.6:
            color = "green"
        elif remaining_time > duration * 0.3:
            color = "yellow"
        else:
            color = "red"
        console.print(f"\r          [bold {color}]ƒêang x·ª≠ l√Ω... {next(spinner)}", end="\r")
        time.sleep(0.0000001)
    console.print("\r          [bold red]Ho√†n th√†nh ", end="\r")
bluesea_id = generate_bluesea_id()
if bluesea_id in AUTHORIZED_PRO_DEVICES:
    gioihan = 1000000000000000000
    owner = AUTHORIZED_PRO_DEVICES[bluesea_id]
    print(f"=== {YELLOW}CH√ÄO M·ª™NG{RESET} ===\r")
    while True:
        os.system('cls' if os.name == 'nt' else 'clear')
        print(f"\n=== {BLUE}BLUESEA PROJECT{RESET}_3.Pro ===")
        print(f"----------copyright: HACKER NGUYEN VAN DUNG")
        print(f"   {YELLOW}QU·∫¢N TR·ªä C·∫§U H√åNH{RESET}")
        print(f"[{YELLOW}1{RESET}] M·ªû T·∫§T C·∫¢ C·∫§U H√åNH")
        print(f"[{YELLOW}2{RESET}] M·ªû CH·ªà ƒê·ªäNH C·∫§U H√åNH")
        print(f"[{YELLOW}3{RESET}] CH·ªàNH S·ª¨A C·∫§U H√åNH")
        print(f"   {RED}HO·∫†T ƒê·ªòNG C·∫§U H√åNH{RESET}")  
        print(f"[{GREEN}4{RESET}] COMMENT FAB")
        print(f"[{GREEN}5{RESET}] LIKE FAB")
        print(f"[{GREEN}6{RESET}] EMOTIONAL FAB  {RED}[NEW]{RESET}")
        print(f"[{GREEN}7{RESET}] MUTIPLE OPITON")
        print(f"[{RED}COMING SOON{RESET}] SMARTCARE")
        print(f"        [X] Tho√°t ch∆∞∆°ng tr√¨nh")
        print(f"\n           ------------------------")
        print(f"           - {YELLOW}{bluesea_id}{RESET} -")
        print(f"           ------------------------")
        choice = input().strip().upper()
        if choice == "1":
            try:
                facebook_all()
            except:
                break
        elif choice == "2":
            try:
                facebook()
            except:
                continue
        elif choice == "3":
                option_menu()
                continue
        elif choice == "4":
                try:
                    running = True
                    listener = keyboard.Listener(on_press=on_press)
                    listener.start()
                    comment()
                except:
                    continue
        elif choice == "5":
                try:
                    running = True
                    listener = keyboard.Listener(on_press=on_press)
                    listener.start()
                    like()
                except Exception as e:
                    print(e)
                    continue
        elif choice == "6":
                try:
                    running = True 
                    listener = keyboard.Listener(on_press=on_press)
                    listener.start()
                    emotion()
                except:
                    continue
        elif choice == "7":
            running = True
            listener = keyboard.Listener(on_press=on_press)
            listener.start()
            da_luong()
        elif choice =="8":
            smart_care()
        elif choice == "H":
            banner()
        elif choice == "X":
                print(f"ƒê√£ {RED}tho√°t ch∆∞∆°ng tr√¨nh{RESET}.")
                break
        else:
                print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
    

else:
     gioihan = 100
     while True:
        os.system('cls' if os.name == 'nt' else 'clear')
        print(f"\n=== {BLUE}BLUESEA PROJECT{RESET}_3.Trial ===")
        print(f"----------copyright: HACKER NGUYEN VAN DUNG")
        print(f"   {YELLOW}QU·∫¢N TR·ªä C·∫§U H√åNH{RESET}")
        print(f"[{YELLOW}1{RESET}] M·ªû CH·ªà ƒê·ªäNH C·∫§U H√åNH")
        print(f"[{YELLOW}2{RESET}] CH·ªàNH S·ª¨A C·∫§U H√åNH")
        print(f"   {RED}HO·∫†T ƒê·ªòNG C·∫§U H√åNH{RESET}")  
        print(f"[{GREEN}3{RESET}] COMMENT POST ANTI BLOCK")
        print(f"[{GREEN}4{RESET}] LIKE POST ANTI BLOCK")
        print(f"        [X] Tho√°t ch∆∞∆°ng tr√¨nh")
        print(f"\n           ------------------------")
        print(f"           - {bluesea_id} -")
        print(f"           ------------------------")
        choice = input().strip().upper()
        if choice == "1":
            try:
                facebook()
            except:
                break
        elif choice == "2":
            try:
                option_menu() 
            except:
                continue
        elif choice == "3":
                try:
                    running = True 
                    listener = keyboard.Listener(on_press=on_press)
                    listener.start()
                    comment()
                except:
                    continue
        elif choice == "4":
                try:
                    running = True
                    listener = keyboard.Listener(on_press=on_press)
                    listener.start()
                    like()
                except:
                    continue
        elif choice == "X":
                print(f"ƒê√£ {RED}tho√°t ch∆∞∆°ng tr√¨nh{RESET}.")
                break
        elif choice == "H":
            banner()
        else:
                print(f"L·ª±a ch·ªçn {RED}kh√¥ng h·ª£p l·ªá{RESET}!")
    
